version: 2.0
scenario: addon-account-manage

hierarchy:
  root: page
  structure:
    page:
      - accountTable
      - topHead
      - referenceModal
    topHead:
      - addAccountButton
      - accountFormModal
    referenceModal:
      children: referenceModalContent
    referenceModalContent:
      - referenceTip
      - referenceTable
    deleteModal:
      children: deleteModalContent
    deleteModalContent:
      - deleteTip
      - referenceTable
      - forceDeleteButton

components:
  referenceModal:
    type: Modal
    props:
      title: 引用详情
      size: big
    state:
      reload: false
      visible: false
  referenceModalContent:
    type: Container
  referenceTable:
    type: Table
    props:
      columns:
        - dataIndex: applicationName
          title: 应用
          width: 120
        - dataIndex: applicationInstance
          title: 应用实例
          width: 120
        - dataIndex: deployPageLink
          title: 部署详情页
          width: 80
    data:
      list:
        - id: 16
          applicationName: erda
          applicationInstance: develop
          projectId: 1
          appId: 1
          runtimeId: 1
          deployPageLink:
            renderType: linkText
            value: 查看
            operations:
              click:
                command:
                  key: goto
                  target: runtimeDetail
                  jumpOut: true
                  state:
                    params:
                      projectId: 2
                      appId: 2
                      runtimeId: 2
                reload: false
    state:
      autoRefresh: false
      visible: false
  referenceTip:
    type: Alert
    props:
      type: normal
      message: 该账号被以下应用所引用，请确认
      showIcon: true
  deleteModal:
    type: Modal
    name: deleteModal
    props:
      title: 删除账号
      size: big
    state:
      reload: false
      visible: true
  deleteTip:
    type: Alert
    props:
      type: warning
      message: 强制删除将影响以下的应用功能，请确认
      showIcon: true
  forceDeleteButton:
    type: Button
    props:
      text: 强制删除
      type: primary
    operations:
      click:
        reload: true
        key: forceDelete
  addAccountButton:
    type: Button
    props:
      text: 创建账号
      type: primary
      operations:
    operations:
      click:
        reload: false
        key: addAccount
        command:
          key: set
          state:
            formData:
            visible: true
          target: accountFormModal
        disabled: false
        disabledTip: ''
  accountFormModal:
    type: FormModal
    name: accountFormModal
    props:
      fields:
        - component: input
          componentProps:
            maxLength: 20
          key: username
          label: 账号
          required: true
          rules:
            - msg: 可输入1-20位英文、数字、中划线或下划线
              pattern: "/^[a-zA-Z0-9_-]{1,20}$/"
        - component: input
          componentProps:
            maxLength: 30
          key: password
          label: 密码
          required: true
          rules:
            - msg: 可输入1-30位字符
              pattern: "/^.{1,30}$/"
      name: ''
      title: 创建账号
    state:
      formData:
      reload: false
      visible: false
    operations:
      submit:
        key: submit
        reload: true
  accountTable:
    type: Table
    name: accountTable
    props:
      className: ''
      columns:
        - data:
          dataIndex: username
          title: 账号
        - data:
          dataIndex: password
          title: 密码
        - data:
          dataIndex: referenceCount
          title: 被引用的次数
        - data:
          dataIndex: creator
          title: 创建者
        - data:
          dataIndex: createdAt
          title: 创建时间
        - data:
          dataIndex: operate
          title: 操作
          width: 180
      pageSizeOptions:
        - '10'
        - '20'
        - '50'
        - '100'
      rowKey: id
      rowSelection:
      title: ''
      visible: true
    data:
      list:
        - id: 16
          username:
            renderType: textWithTags
            value: abc
            tags:
              - tag: 主账号
                color: green
          password: "******"
          referenceCount:
            renderType: linkText
            value: 12
            operations:
              click:
                command:
                  key: set
                  state:
                    visible: true
                    id: 16
                  target: referenceModal
                disabled: false
                disabledTip: 无操作权限，请联系项目所有者/项目经理开通操作权限
                key: edit
                reload: false
                showIndex: 1
                successMsg: ''
                text: 编辑
          creator: Mike
          createdAt: 2021-10-01 12:00
          operate:
            operations:
              setMain:
                confirm: 主账号将被新引用应用或者已引用应用重启后使用，请确认是否要设置
                disabled: false
                disabledTip: ''
                key: setMain
                meta:
                  id: 16
                reload: true
                showIndex: 1
                successMsg: ''
                text: 设置为主账号
              delete:
                confirm: 是否确认删除
                disabled: false
                disabledTip: 无法删除
                key: delete
                meta:
                  id: 16
                reload: true
                showIndex: 2
                successMsg: 删除成功
                text: 删除
            renderType: tableOperation
            value: ''
    state:
      pageNo: 1
      pageSize: 10
      total: 5
    operations:
      changePageNo:
        key: changePageNo
        reload: true
      changePageSize:
        key: changePageSize
        reload: true
      clickRow:
        key: clickRow
        reload: false
        command:
          key: goto
          state: {}
          target: project_test_spaceDetail_scenes
          jumpOut: false
  page:
    type: Container
    name: page
  topHead:
    type: RowContainer
    name: topHead
    props:
      isTopHead: true

rendering:
  __DefaultRendering__:
    - name: page
