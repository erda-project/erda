# Design

## 基本定义

### 字段定义

组件权重：fields.weight

- 非关键：0
- 关键：1

数据&告警等级：fields.level

- 正常：0
- 风险：1
- 部分故障：2
- 严重故障：3

组件&节点名：tags.component_name

消息：tag.message

健康状态：fields.health_status

- 健康：0
- 存在风险：1
- 部分故障：2
- 严重故障：3

## 算法

变量：

- Weight: 消息关联组件的权重。分为关键(1)、非关键(0)
- health_status: 等级。例如宕机告警的数据代表 故障等级。无故障(0)、风险(1)、部分故障(2)、全部故障(3)
- Portion: 异常状态节点的比例。分为部分(0)、全部(1)

用一个三元数组代表(weight, health_status, portion)，通过一个hash表得到健康状态。

若同时存在多种等级情况，取最高值

| (weight, level, portion) | Health   | Description        |
| ------------------------ | -------- | ------------------ |
| \*,0,*                   | 健康     | 健康               |
| 0,1,0                    | 风险     | 部分非关键组件风险 |
| 0,1,1                    | 风险     | 所有非关键组件风险 |
| 0,2,0                    | 风险     | 部分非关键组件故障 |
| 0,2,1                    | 风险     | 所有非关键组件故障 |
| 1,1,0                    | 风险     | 部分关键组件风险   |
| 1,1,1                    | 风险     | 所有关键组件风险   |
| 1,2,0                    | 部分故障 | 部分关键组件故障   |
| 1,2,1                    | 严重故障 | 全部关键组件故障   |

例子：

某个非关键机器同时存在宕机告警和负载过高告警，该机器的节点状态为故障；同时，其他机器均正常。则节点状态为*风险*

## 步骤
