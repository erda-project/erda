{
  "id": "weekly",
  "name": "企业运维周报模版",
  "scope": "report",
  "scopeId": "org",
  "viewConfig": [
    {
      "w": 4,
      "h": 4,
      "x": 0,
      "y": 1,
      "i": "d11",
      "view": {
        "title": "机器资源概况",
        "description": "",
        "chartType": "card",
        "dataSourceType": "static",
        "api": {
          "url": "/api/metrics/cluster_resource",
          "query": {
            "start": "before_5m",
            "end": "now",
            "align": false,
            "cardinality": "tags.host_ip",
            "filter_org_name": "",
            "format":"chartv2"
          },
          "body": {},
          "method": "GET",
          "header": {}
        }
      }
    },
    {
      "w": 4,
      "h": 4,
      "x": 4,
      "y": 1,
      "i": "d13",
      "view": {
        "title": " ",
        "description": "",
        "chartType": "card",
        "dataSourceType": "static",
        "api": {
          "url": "/api/metrics/cluster_resource",
          "query": {
            "start": "before_5m",
            "end": "now",
            "align": false,
            "group_reduce": "{group=tags.host_ip&last=fields.n_cpus&reduce=sum}",
            "filter_org_name": "",
            "format":"chartv2"
          },
          "body": {},
          "method": "GET",
          "header": {}
        }
      }
    },
    {
      "w": 4,
      "h": 4,
      "x": 9,
      "y": 1,
      "i": "d14",
      "view": {
        "title": " ",
        "description": "",
        "chartType": "card",
        "dataSourceType": "static",
        "api": {
          "url": "/api/metrics/cluster_resource",
          "query": {
            "start": "before_5m",
            "end": "now",
            "align": false,
            "group_reduce": "{group=tags.host_ip&last=fields.mem_total&reduce=sum}",
            "filter_org_name": "",
            "format":"chartv2"
          },
          "body": {},
          "method": "GET",
          "header": {}
        }
      }
    },
    {
      "w": 4,
      "h": 4,
      "x": 14,
      "y": 1,
      "i": "d15",
      "view": {
        "title": " ",
        "description": "",
        "chartType": "card",
        "dataSourceType": "static",
        "api": {
          "url": "/api/metrics/cluster_resource",
          "query": {
            "start": "before_5m",
            "end": "now",
            "align": false,
            "group_reduce": "{group=tags.host_ip&last=fields.cpu_request_total&reduce=sum}",
            "filter_org_name": "",
            "format":"chartv2"
          },
          "body": {},
          "method": "GET",
          "header": {}
        }
      }
    },
    {
      "w": 4,
      "h": 4,
      "x": 19,
      "y": 1,
      "i": "d16",
      "view": {
        "title": " ",
        "description": "",
        "chartType": "card",
        "dataSourceType": "static",
        "api": {
          "url": "/api/metrics/cluster_resource",
          "query": {
            "start": "before_5m",
            "end": "now",
            "align": false,
            "group_reduce": "{group=tags.host_ip&last=fields.mem_request_total&reduce=sum}",
            "filter_org_name": "",
            "format":"chartv2"
          },
          "body": {},
          "method": "GET",
          "header": {}
        }
      }
    },

    {
      "w": 4,
      "h": 4,
      "x": 0,
      "y": 5,
      "i": "d21",
      "view": {
        "title": "项目资源概况",
        "description": "",
        "chartType": "card",
        "dataSourceType": "static",
        "api": {
          "url": "/api/metrics/project_resource",
          "query": {
            "start": "before_5m",
            "end": "now",
            "align": false,
            "cardinality": "tags.project_id",
            "filter_org_name": "",
            "format":"chartv2"
          },
          "body": {},
          "method": "GET",
          "header": {}
        }
      }
    },
    {
      "w": 4,
      "h": 4,
      "x": 4,
      "y": 5,
      "i": "d22",
      "view": {
        "title": " ",
        "description": "",
        "chartType": "card",
        "dataSourceType": "static",
        "api": {
          "url": "/api/metrics/project_resource",
          "query": {
            "start": "before_5m",
            "end": "now",
            "align": false,
            "cardinality": "tags.service_id",
            "filter_org_name": "",
            "format":"chartv2"
          },
          "body": {},
          "method": "GET",
          "header": {}
        }
      }
    },
    {
      "w": 4,
      "h": 4,
      "x": 8,
      "y": 5,
      "i": "d23",
      "view": {
        "title": " ",
        "description": "",
        "chartType": "card",
        "dataSourceType": "static",
        "api": {
          "url": "/api/metrics/project_resource",
          "query": {
            "start": "before_5m",
            "end": "now",
            "align": false,
            "cardinality": "tags.container_id",
            "filter_instance_type": "service",
            "filter_org_name": "",
            "format":"chartv2"
          },
          "body": {},
          "method": "GET",
          "header": {}
        }
      }
    },
    {
      "w": 4,
      "h": 4,
      "x": 12,
      "y": 5,
      "i": "d24",
      "view": {
        "title": " ",
        "description": "",
        "chartType": "card",
        "dataSourceType": "static",
        "api": {
          "url": "/api/metrics/project_resource",
          "query": {
            "start": "before_5m",
            "end": "now",
            "align": false,
            "cardinality": "tags.addon_id",
            "filter_instance_type": "addon",
            "filter_org_name": "",
            "format":"chartv2",
            "match_project_id":"*"
          },
          "body": {},
          "method": "GET",
          "header": {}
        }
      }
    },
    {
      "w": 4,
      "h": 4,
      "x": 16,
      "y": 5,
      "i": "d25",
      "view": {
        "title": " ",
        "description": "",
        "chartType": "card",
        "dataSourceType": "static",
        "api": {
          "url": "/api/metrics/project_resource",
          "query": {
            "start": "before_5m",
            "end": "now",
            "align": false,
            "group_reduce": "{group=tags.container_id&last=fields.cpu_allocation&reduce=sum}",
            "filter_org_name": "",
            "format":"chartv2",
            "match_project_id":"*"
          },
          "body": {},
          "method": "GET",
          "header": {}
        }
      }
    },
    {
      "w": 4,
      "h": 4,
      "x": 20,
      "y": 5,
      "i": "d26",
      "view": {
        "title": " ",
        "description": "",
        "chartType": "card",
        "dataSourceType": "static",
        "api": {
          "url": "/api/metrics/project_resource",
          "query": {
            "start": "before_5m",
            "end": "now",
            "align": false,
            "group_reduce": "{group=tags.container_id&last=fields.mem_allocation&reduce=sum}",
            "filter_org_name": "",
            "format":"chartv2",
            "match_project_id":"*"
          },
          "body": {},
          "method": "GET",
          "header": {}
        }
      }
    },
    {
      "w": 24,
      "h": 6,
      "x": 0,
      "y": 10,
      "i": "d31",
      "view": {
        "title": "项目资源使用Top5",
        "description": "",
        "chartType": "table",
        "dataSourceType": "static",
        "staticData": null,
        "api": {
          "url": "/api/metrics/project_resource_use",
          "query": {
            "start": "before_5m",
            "end": "now",
            "align": false,
            "format": "chartv2",
            "last": "tags.project_name",
            "group": "project_id",
            "group_reduce": ["{group=tags.container_id&last=fields.mem_allocation&reduce=sum}","{group=tags.container_id&last=fields.cpu_allocation&reduce=sum}"],
            "cardinality": "tags.service_id",
            "limit": 5,
            "filter_org_name": "",
            "sort": "cardinality_tags.service_id",
            "match_project_id":"*"
          },
          "body": {},
          "method": "GET",
          "header": {}
        }
      }
    },
    {
      "w": 24,
      "h": 9,
      "x": 0,
      "y": 20,
      "i": "d41",
      "view": {
        "title": "异常机器数",
        "description": "",
        "chartType": "chart:line",
        "dataSourceType": "static",
        "staticData": null,
        "config": {
          "optionProps": {
            "isMoreThanOneDay": true,
            "moreThanOneDayFormat": "M/D"
          }
        },
        "api": {
          "url": "/api/metrics/alert_resource/histogram",
          "query": {
            "start": "before_168h",
            "end": "now",
            "points": "7",
            "align": false,
            "filter_alert_type": "machine",
            "cardinality": "tags.host_ip",
            "filter_trigger": "alert",
            "filter_dice_org_id": ""
          },
          "body": {},
          "method": "GET",
          "header": {}
        }
      }
    },
    {
      "w": 24,
      "h": 9,
      "x": 0,
      "y": 30,
      "i": "d51",
      "view": {
        "title": "机器异常持续时间",
        "description": "",
        "chartType": "chart:line",
        "dataSourceType": "static",
        "config": {
          "optionProps": {
            "isMoreThanOneDay": true,
            "moreThanOneDayFormat": "M/D",
            "unit": "ms"
          }
        },
        "api": {
          "url": "/api/metrics/alert_resource/histogram",
          "query": {
            "start": "before_168h",
            "end": "now",
            "points": "7",
            "align": false,
            "filter_alert_type": "machine",
            "sum": "fields.trigger_duration",
            "filter_dice_org_id": ""
          },
          "body": {},
          "method": "GET",
          "header": {}
        }
      }
    },
    {
      "w": 24,
      "h": 9,
      "x": 0,
      "y": 40,
      "i": "d61",
      "view": {
        "title": "告警趋势",
        "description": "",
        "chartType": "chart:line",
        "dataSourceType": "static",
        "config": {
          "optionProps": {
            "isMoreThanOneDay": true,
            "moreThanOneDayFormat": "M/D"
          }
        },
        "api": {
          "url": "/api/metrics/alert_resource/histogram",
          "query": {
            "start": "before_168h",
            "end": "now",
            "points": "7",
            "align": false,
            "count": "tags.alert_id",
            "filter_trigger": "alert",
            "filter_dice_org_id": ""
          },
          "body": {},
          "method": "GET",
          "header": {}
        }
      }
    },
    {
      "w": 24,
      "h": 9,
      "x": 0,
      "y": 50,
      "i": "d71",
      "view": {
        "title": "告警类别分析",
        "description": "",
        "chartType": "chart:pie",
        "dataSourceType": "static",
        "api": {
          "url": "/api/metrics/alert_resource",
          "query": {
            "start": "before_168h",
            "end": "now",
            "group": "alert_type",
            "count": "tags.alert_type",
            "filter_trigger": "alert",
            "filter_dice_org_id": "",
            "format":"chartv2"
          },
          "body": {},
          "method": "GET",
          "header": {}
        }
      }
    },
    {
      "w": 24,
      "h": 9,
      "x": 0,
      "y": 60,
      "i": "d81",
      "view": {
        "title": "API网关流量",
        "description": "",
        "chartType": "chart:line",
        "dataSourceType": "static",
        "config": {
          "optionProps": {
            "isMoreThanOneDay": true,
            "moreThanOneDayFormat": "M/D"
          }
        },
        "api": {
          "url": "/api/metrics/app_resource/histogram",
          "query": {
            "start": "before_168h",
            "end": "now",
            "points": "7",
            "align": false,
            "filter_target_addon_id": "ApiGateway",
            "sum": "elapsed_count",
            "filter_org_name":""
          },
          "body": {},
          "method": "GET",
          "header": {}
        }
      }
    },
    {
      "w": 24,
      "h": 9,
      "x": 0,
      "y": 70,
      "i": "d91",
      "view": {
        "title": "服务和Addon OOM次数",
        "description": "",
        "chartType": "chart:bar",
        "dataSourceType": "static",
        "config": {
          "optionProps": {
            "isMoreThanOneDay": true,
            "moreThanOneDayFormat": "M/D"
          }
        },
        "api":{
          "url": "/api/metrics/project_resource/histogram",
          "query": {
            "start": "before_168h",
            "end": "now",
            "points": "7",
            "align": false,
            "field_eq_oomkilled": "b:true",
            "cardinality": ["tags.service_id","tags.addon_id"],
            "filter_org_name":""
          },
          "body": {},
          "method": "GET",
          "header": {}
        }
      }
    },
    {
      "w": 24,
      "h": 11,
      "x": 0,
      "y": 80,
      "i": "d101",
      "view": {
        "title": "项目OOM次数 Top10",
        "description": "根据服务OOM次数排序",
        "chartType": "table",
        "dataSourceType": "static",
        "api":{
          "url": "/api/metrics/project_oom_resource",
          "query": {
            "start": "before_168h",
            "end": "now",
            "align": false,
            "group":"tags.project_id",
            "last": "tags.project_name",
            "field_eq_oomkilled": "b:true",
            "cardinality": ["tags.service_id","tags.addon_id"],
            "filter_org_name":"",
            "format":"chartv2",
            "sort": "cardinality_tags.service_id",
            "limit": 10
          },
          "body": {},
          "method": "GET",
          "header": {}
        }
      }
    }
  ],
  "desc": "企业运维周报模版"
}