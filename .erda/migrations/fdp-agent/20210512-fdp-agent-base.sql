# MIGRATION_BASE

CREATE TABLE `fdp_agent_ad_hoc_cache_data` (
  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '主键id',
  `result` longtext COLLATE utf8mb4_unicode_ci NOT NULL COMMENT '即席查询结果',
  `creator_id` varchar(256) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '创建人 ID',
  `updater_id` varchar(256) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '修改人 ID',
  `delete_yn` tinyint(1) NOT NULL DEFAULT '0' COMMENT '逻辑删除标记',
  `created_at` datetime NOT NULL COMMENT '表记录创建时间',
  `updated_at` datetime NOT NULL COMMENT '表记录更新时间',
  `cluster_id` bigint(20) DEFAULT NULL COMMENT '集群id',
  `project_id` bigint(20) DEFAULT '1' COMMENT '项目id',
  `org_id` bigint(20) DEFAULT NULL COMMENT '集群id',
  `application_id` bigint(20) DEFAULT NULL COMMENT '应用id',
  `cluster_name` varchar(256) COLLATE utf8mb4_unicode_ci DEFAULT '' COMMENT '集群名称',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=7 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='即席查询缓存记录表';

CREATE TABLE `fdp_agent_algorithm_model_manage` (
  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '主键id',
  `model_name` varchar(128) NOT NULL COMMENT '模型名称',
  `algorithm_name` varchar(256) DEFAULT NULL COMMENT '算法名称',
  `feature_list` varchar(1024) DEFAULT NULL COMMENT '特征列',
  `target_list` varchar(1024) DEFAULT NULL COMMENT '目标列',
  `params` varchar(1024) DEFAULT NULL COMMENT '参数',
  `model_file_name` varchar(256) DEFAULT NULL COMMENT '模型文件名称',
  `model_file_url` varchar(1024) DEFAULT NULL COMMENT '模型文件地址',
  `model_version` varchar(45) NOT NULL DEFAULT '0' COMMENT '模型版本',
  `model_status` varchar(32) DEFAULT NULL COMMENT '发布状态',
  `api_url` varchar(1024) DEFAULT NULL COMMENT '调用api',
  `package_id` varchar(128) DEFAULT NULL COMMENT '流量入口ID',
  `consumer_id` varchar(128) DEFAULT NULL COMMENT '调用方ID',
  `creator_id` varchar(128) DEFAULT NULL COMMENT '创建人 ID',
  `updater_id` varchar(128) DEFAULT NULL COMMENT '更新者ID',
  `delete_yn` tinyint(1) NOT NULL DEFAULT '0' COMMENT '逻辑删除标记',
  `created_at` datetime NOT NULL COMMENT '表记录创建时间',
  `updated_at` datetime NOT NULL COMMENT '表记录更新时间',
  `cluster_id` bigint(20) DEFAULT NULL COMMENT '集群id',
  `project_id` bigint(20) DEFAULT '1' COMMENT '项目id',
  `org_id` bigint(20) DEFAULT NULL COMMENT '集群id',
  `application_id` bigint(20) DEFAULT NULL COMMENT '应用id',
  `cluster_name` varchar(256) DEFAULT '' COMMENT '集群名称',
  PRIMARY KEY (`id`),
  KEY `key_model_name` (`model_name`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='模型管理';

CREATE TABLE `fdp_agent_label_work_relation` (
  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '主键id',
  `label_id` bigint(20) NOT NULL COMMENT '标签名',
  `workflow_id` bigint(20) NOT NULL COMMENT '标签颜色',
  `module` varchar(64) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '标签所属模块: DATA_SOURCE, DATA_MODEL',
  `creator_id` varchar(256) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '创建人 ID',
  `delete_yn` tinyint(1) NOT NULL DEFAULT '0' COMMENT '逻辑删除标记',
  `created_at` datetime NOT NULL COMMENT '表记录创建时间',
  `updated_at` datetime NOT NULL COMMENT '表记录更新时间',
  `cluster_id` bigint(20) DEFAULT NULL COMMENT '集群id',
  `project_id` bigint(20) DEFAULT '1' COMMENT '项目id',
  `org_id` bigint(20) DEFAULT NULL COMMENT '集群id',
  `application_id` bigint(20) DEFAULT NULL COMMENT '应用id',
  `cluster_name` varchar(256) COLLATE utf8mb4_unicode_ci DEFAULT '' COMMENT '集群名称',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=226 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='标签工作流关联表';

CREATE TABLE `fdp_agent_onedata_metrics` (
  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT,
  `category_id` bigint(20) unsigned NOT NULL COMMENT '文件目录ID',
  `workflow_category_id` bigint(20) DEFAULT NULL COMMENT '派生指标创建工作流目录ID',
  `workflow_id` bigint(20) DEFAULT NULL COMMENT '工作流ID',
  `workflow_location` varchar(255) DEFAULT NULL COMMENT '工作流节点坐标',
  `workflow_node_id` bigint(20) DEFAULT NULL COMMENT '工作流节点ID',
  `metrics_name` varchar(256) DEFAULT '' COMMENT '指标名称',
  `metrics_type` varchar(128) DEFAULT '' COMMENT '指标类型, 原子指标/派生指标',
  `metrics_name_en` varchar(256) DEFAULT '' COMMENT '指标英文名称',
  `metrics_def` varchar(256) DEFAULT '' COMMENT '指标定义',
  `metrics_caliber` varchar(128) DEFAULT '' COMMENT '指标口径',
  `selected_method` varchar(256) DEFAULT '' COMMENT '选择方法',
  `metrics_measure` varchar(256) DEFAULT '' COMMENT '计量单位',
  `model_name` varchar(256) DEFAULT '' COMMENT '模型名称',
  `column_name` varchar(256) DEFAULT '' COMMENT '字段名称',
  `process_logic` varchar(256) DEFAULT '' COMMENT '处理逻辑',
  `metrics_sample` varchar(256) DEFAULT '' COMMENT '示例数据',
  `metrics_period` varchar(256) DEFAULT '' COMMENT '统计周期',
  `metrics_restrict` varchar(256) DEFAULT '' COMMENT '业务限定',
  `metrics_granularity` varchar(1024) DEFAULT NULL COMMENT '统计粒度',
  `rel_metrics_id` bigint(20) DEFAULT NULL COMMENT '派生指标关联的原子指标ID',
  `is_referred` tinyint(1) DEFAULT NULL COMMENT '是否被引用',
  `creator_id` varchar(255) DEFAULT NULL COMMENT '创建人 ID',
  `updater_id` varchar(128) DEFAULT NULL COMMENT '更新者 ID',
  `delete_yn` tinyint(1) DEFAULT NULL COMMENT '逻辑删除标记',
  `created_at` datetime NOT NULL COMMENT '表记录创建时间',
  `updated_at` datetime NOT NULL COMMENT '表记录更新时间',
  `org_id` bigint(20) DEFAULT NULL COMMENT '企业 id',
  `cluster_id` bigint(20) DEFAULT NULL COMMENT '集群id',
  `project_id` bigint(20) DEFAULT NULL COMMENT '项目id',
  `application_id` bigint(20) DEFAULT NULL COMMENT '应用id',
  `cluster_name` varchar(256) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT '集群名',
  PRIMARY KEY (`id`),
  KEY `FK_category_id` (`category_id`),
  KEY `idx_rel_metrics_id` (`rel_metrics_id`),
  CONSTRAINT `FK_category_id` FOREIGN KEY (`category_id`) REFERENCES `fdp_agent_onedata_metrics_category` (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='指标定义表';

CREATE TABLE `fdp_agent_onedata_metrics_category` (
  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT,
  `subject_id` bigint(20) unsigned NOT NULL COMMENT '主题域 ID',
  `name` varchar(128) NOT NULL DEFAULT '' COMMENT '目录名',
  `name_pinyin` varchar(128) NOT NULL DEFAULT '' COMMENT '目录名拼音',
  `parent_id` bigint(20) NOT NULL COMMENT '上级目录 ID',
  `creator_id` varchar(255) DEFAULT '' COMMENT '创建人 ID',
  `updater_id` varchar(128) DEFAULT '' COMMENT '更新者 ID',
  `delete_yn` tinyint(1) DEFAULT '0' COMMENT '逻辑删除标记',
  `created_at` datetime NOT NULL COMMENT '表记录创建时间',
  `updated_at` datetime NOT NULL COMMENT '表记录更新时间',
  `org_id` bigint(20) DEFAULT NULL COMMENT '企业 id',
  `cluster_id` bigint(20) DEFAULT NULL COMMENT '集群id',
  `project_id` bigint(20) DEFAULT NULL COMMENT '项目id',
  `application_id` bigint(20) DEFAULT NULL COMMENT '应用id',
  `cluster_name` varchar(256) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT '集群名',
  PRIMARY KEY (`id`),
  KEY `FK_subject_id` (`subject_id`),
  CONSTRAINT `FK_subject_id` FOREIGN KEY (`subject_id`) REFERENCES `fdp_agent_onedata_subject` (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='指标定义目录表';

CREATE TABLE `fdp_agent_onedata_model_relation` (
  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT,
  `org_id` bigint(20) DEFAULT NULL COMMENT '企业 id',
  `name` varchar(256) NOT NULL COMMENT '关系网名称',
  `main_model_id` bigint(20) DEFAULT NULL COMMENT '主模型ID',
  `creator_id` varchar(255) DEFAULT '' COMMENT '创建人 ID',
  `updater_id` varchar(128) DEFAULT '' COMMENT '更新者 ID',
  `delete_yn` tinyint(1) NOT NULL DEFAULT '0' COMMENT '逻辑删除标记',
  `created_at` datetime NOT NULL COMMENT '表记录创建时间',
  `updated_at` datetime NOT NULL COMMENT '表记录更新时间',
  `application_id` bigint(20) DEFAULT NULL COMMENT '应用id',
  `platform_id` bigint(20) DEFAULT '0' COMMENT '平台 id',
  `cluster_id` bigint(20) DEFAULT NULL COMMENT '集群id',
  `project_id` bigint(20) DEFAULT NULL COMMENT '项目id',
  `cluster_name` varchar(256) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT '集群名',
  PRIMARY KEY (`id`),
  KEY `idx_main_model_id` (`main_model_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

CREATE TABLE `fdp_agent_onedata_model_relation_rel_model_field` (
  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT,
  `org_id` bigint(20) DEFAULT NULL COMMENT '企业 id',
  `model_relation_id` bigint(20) unsigned NOT NULL COMMENT '模型关系网ID',
  `main_model_field` varchar(256) DEFAULT NULL COMMENT '主模型字段',
  `rel_model_id` bigint(20) DEFAULT NULL COMMENT '关联数据模型ID',
  `rel_model_field` varchar(256) DEFAULT NULL COMMENT '关联数据模型字段名称',
  `rel_type` varchar(255) DEFAULT NULL COMMENT '关联类型',
  `process_logic` varchar(256) DEFAULT NULL COMMENT '处理逻辑',
  `creator_id` varchar(256) DEFAULT '' COMMENT '创建人 ID',
  `updater_id` varchar(128) DEFAULT '' COMMENT '更新者 ID',
  `delete_yn` tinyint(1) NOT NULL DEFAULT '0' COMMENT '逻辑删除标记',
  `created_at` datetime NOT NULL COMMENT '表记录创建时间',
  `updated_at` datetime NOT NULL COMMENT '表记录更新时间',
  `project_id` bigint(20) DEFAULT NULL COMMENT '项目id',
  `application_id` bigint(20) DEFAULT NULL COMMENT '应用id',
  `platform_id` bigint(20) DEFAULT '0' COMMENT '平台 id',
  `cluster_id` bigint(20) DEFAULT NULL COMMENT '集群id',
  `cluster_name` varchar(256) DEFAULT '' COMMENT '集群名称',
  PRIMARY KEY (`id`),
  KEY `FK_model_relation_id` (`model_relation_id`),
  KEY `idx_rel_model_field` (`main_model_field`(255),`rel_model_id`,`rel_model_field`(255)),
  KEY `idx_rel_model_id` (`rel_model_id`),
  CONSTRAINT `FK_model_relation_id` FOREIGN KEY (`model_relation_id`) REFERENCES `fdp_agent_onedata_model_relation` (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

CREATE TABLE `fdp_agent_onedata_period` (
  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT,
  `name` varchar(128) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '限定名称',
  `english` varchar(128) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '英文名',
  `start_time` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT '开始时间',
  `end_time` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT '结束时间',
  `method` varchar(128) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '计算逻辑',
  `creator_id` varchar(128) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT '创建者id',
  `updated_id` varchar(128) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT '修改者id',
  `created_at` datetime NOT NULL COMMENT '表记录创建时间',
  `updated_at` datetime NOT NULL COMMENT '表记录更新时间',
  `org_id` bigint(20) DEFAULT NULL COMMENT '企业 id',
  `cluster_id` bigint(20) DEFAULT NULL COMMENT '集群id',
  `project_id` bigint(20) DEFAULT NULL COMMENT '项目id',
  `application_id` bigint(20) DEFAULT NULL COMMENT '应用id',
  `cluster_name` varchar(256) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT '集群名',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='统计周期表';

CREATE TABLE `fdp_agent_onedata_restrict` (
  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT,
  `name` varchar(128) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '限定名称',
  `english` varchar(128) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '英文名',
  `method` varchar(128) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '计算逻辑',
  `real_model` varchar(128) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT '引用模型',
  `real_field` varchar(128) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT '引用字段',
  `creator_id` varchar(128) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT '创建者id',
  `data_model_id` bigint(20) DEFAULT NULL,
  `updated_id` varchar(128) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT '修改者id',
  `created_at` datetime NOT NULL COMMENT '表记录创建时间',
  `updated_at` datetime NOT NULL COMMENT '表记录更新时间',
  `data_field_id` bigint(20) DEFAULT NULL,
  `org_id` bigint(20) DEFAULT NULL COMMENT '企业 id',
  `cluster_id` bigint(20) DEFAULT NULL COMMENT '集群id',
  `project_id` bigint(20) DEFAULT NULL COMMENT '项目id',
  `application_id` bigint(20) DEFAULT NULL COMMENT '应用id',
  `cluster_name` varchar(256) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT '集群名',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='业务限定表';

CREATE TABLE `fdp_agent_onedata_subject` (
  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '主键id',
  `subject_name` varchar(64) NOT NULL DEFAULT '' COMMENT '主题域名称',
  `subject_desc` varchar(255) NOT NULL DEFAULT '' COMMENT '主题域说明',
  `subject_prefix` varchar(64) NOT NULL DEFAULT '' COMMENT '主题域前缀',
  `updater_id` varchar(128) NOT NULL COMMENT '更新者 ID',
  `updated_at` datetime NOT NULL COMMENT '最近修改时间',
  `delete_yn` tinyint(1) NOT NULL DEFAULT '0' COMMENT '逻辑删除标记',
  `creator_id` varchar(128) NOT NULL COMMENT '创建人 ID',
  `created_at` datetime NOT NULL COMMENT '创建时间',
  `org_id` bigint(20) DEFAULT NULL COMMENT '企业id',
  `cluster_id` bigint(20) DEFAULT NULL COMMENT '集群id',
  `project_id` bigint(20) DEFAULT NULL COMMENT '项目id',
  `application_id` bigint(20) DEFAULT NULL COMMENT '应用id',
  `cluster_name` varchar(256) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT '集群名',
  `platform_id` bigint(20) DEFAULT NULL COMMENT '平台id',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='onedata主题域表';

CREATE TABLE `fdp_agent_sql_history` (
  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '主键id',
  `cache_data_id` bigint(20) unsigned NOT NULL COMMENT '数据缓存id',
  `name` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '执行记录名称',
  `query_status` varchar(128) NOT NULL COMMENT '查询响应状态',
  `query_time` bigint(20) NOT NULL COMMENT '查询耗时',
  `sql` text NOT NULL COMMENT '查询sql',
  `data_model_name` varchar(255) NOT NULL COMMENT '数据模型 名称',
  `data_source_id` bigint(20) NOT NULL COMMENT '数据源 ID',
  `delete_yn` tinyint(1) NOT NULL DEFAULT '0' COMMENT '逻辑删除标记',
  `creator_id` varchar(128) DEFAULT NULL COMMENT '创建人 ID',
  `updater_id` varchar(128) DEFAULT NULL COMMENT '更新者ID',
  `created_at` datetime NOT NULL COMMENT '创建时间',
  `updated_at` datetime NOT NULL COMMENT '更新时间',
  `code` varchar(255) DEFAULT NULL COMMENT '数据模型 名称',
  `error` text COMMENT '数据模型 名称',
  `sourceStack` text COMMENT '数据模型 名称',
  `columns` text COMMENT '数据模型 名称',
  `logs` text COMMENT '数据模型 名称',
  `cluster_id` bigint(20) DEFAULT NULL COMMENT '集群id',
  `project_id` bigint(20) DEFAULT '1' COMMENT '项目id',
  `org_id` bigint(20) DEFAULT NULL COMMENT '集群id',
  `application_id` bigint(20) DEFAULT NULL COMMENT '应用id',
  `cluster_name` varchar(256) DEFAULT '' COMMENT '集群名称',
  PRIMARY KEY (`id`),
  KEY `abc` (`cache_data_id`),
  CONSTRAINT `abc` FOREIGN KEY (`cache_data_id`) REFERENCES `fdp_agent_ad_hoc_cache_data` (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='sql执行历史表';

CREATE TABLE `fdp_agent_task_queue` (
  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '主键id',
  `name` varchar(128) DEFAULT NULL COMMENT '名字',
  `cpu` double(20,2) DEFAULT NULL COMMENT 'cpu',
  `memory` double(20,2) DEFAULT NULL COMMENT 'memory',
  `strategy` varchar(128) DEFAULT 'FIFO' COMMENT '调度策略',
  `level` bigint(20) DEFAULT NULL COMMENT '队列权重',
  `pipeline_create_id` bigint(20) DEFAULT NULL COMMENT 'pipeline组件创建队列的id',
  `creator_id` varchar(128) DEFAULT NULL COMMENT '创建人 ID',
  `updater_id` varchar(128) DEFAULT NULL COMMENT '更新者ID',
  `created_at` datetime NOT NULL COMMENT '创建时间',
  `updated_at` datetime NOT NULL COMMENT '更新时间',
  `org_id` bigint(20) DEFAULT NULL COMMENT '企业 id',
  `project_id` bigint(20) DEFAULT NULL COMMENT '项目 id',
  `application_id` bigint(20) DEFAULT NULL COMMENT '应用 id',
  `cluster_id` bigint(20) DEFAULT NULL COMMENT '集群 id',
  `cluster_name` varchar(256) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT '集群名',
  `status` tinyint(4) DEFAULT NULL COMMENT 'pipeline队列创建情况',
  `concurrency` bigint(20) DEFAULT NULL COMMENT '并行度',
  `mode` varchar(256) DEFAULT '' COMMENT '模式',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=2 DEFAULT CHARSET=utf8 COMMENT='任务队列表';


INSERT INTO `fdp_agent_task_queue` (`id`, `name`, `cpu`, `memory`, `strategy`, `level`, `pipeline_create_id`, `creator_id`, `updater_id`, `created_at`, `updated_at`, `org_id`, `project_id`, `application_id`, `cluster_id`, `cluster_name`, `status`, `concurrency`, `mode`) VALUES (1,'默认队列',3.00,6144.00,'FIFO',1,NULL,NULL,NULL,'2021-03-09 15:23:54','2021-03-09 15:25:16',1,1,NULL,1,NULL,1,3,'LOOSE');

CREATE TABLE `fdp_agent_work_project` (
  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '主键id',
  `name` varchar(128) DEFAULT NULL COMMENT 'gittar project id',
  `alias` varchar(128) DEFAULT NULL COMMENT 'gittar project 名字',
  `delete_yn` tinyint(1) NOT NULL DEFAULT '0' COMMENT '逻辑删除标记',
  `creator_id` varchar(128) DEFAULT NULL COMMENT '创建人 ID',
  `updater_id` varchar(128) DEFAULT NULL COMMENT '更新者ID',
  `created_at` datetime NOT NULL COMMENT '创建时间',
  `updated_at` datetime NOT NULL COMMENT '更新时间',
  `org_id` bigint(20) DEFAULT NULL COMMENT '企业 id',
  `project_id` bigint(20) DEFAULT NULL COMMENT '项目 id',
  `application_id` bigint(20) DEFAULT NULL COMMENT '应用 id',
  `cluster_id` bigint(20) DEFAULT NULL COMMENT '集群 id',
  `cluster_name` varchar(256) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT '集群名',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=2 DEFAULT CHARSET=utf8 COMMENT='工作空间表';


INSERT INTO `fdp_agent_work_project` (`id`, `name`, `alias`, `delete_yn`, `creator_id`, `updater_id`, `created_at`, `updated_at`, `org_id`, `project_id`, `application_id`, `cluster_id`, `cluster_name`) VALUES (1,'默认空间','default',0,'1','1','2021-01-29 14:38:37','2021-02-04 15:56:41',NULL,0,0,1,NULL);

CREATE TABLE `fdp_agent_work_template_yaml` (
  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '主键id',
  `name` varchar(128) DEFAULT NULL COMMENT '第三方服务名称',
  `template` longtext,
  `org_id` bigint(20) DEFAULT NULL COMMENT '企业 id',
  `project_id` bigint(20) DEFAULT NULL COMMENT '项目 id',
  `application_id` bigint(20) DEFAULT NULL COMMENT '应用 id',
  `cluster_id` bigint(20) DEFAULT NULL COMMENT '集群 id',
  `cluster_name` varchar(256) CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT '集群名',
  `creator_id` varchar(128) DEFAULT NULL COMMENT '创建者id',
  `created_at` datetime NOT NULL COMMENT '创建时间',
  `updated_at` datetime NOT NULL COMMENT '更新时间',
  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='提交spark，flinkyaml模版';

CREATE TABLE `fdp_agent_workflow_node` (
  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '主键id',
  `workflow_id` bigint(20) NOT NULL COMMENT 'workflow id',
  `name` varchar(128) COLLATE utf8mb4_unicode_ci NOT NULL COMMENT '节点名称',
  `created_at` datetime NOT NULL COMMENT '表记录创建时间',
  `x` varchar(128) COLLATE utf8mb4_unicode_ci NOT NULL COMMENT 'x轴坐标',
  `y` varchar(128) COLLATE utf8mb4_unicode_ci NOT NULL COMMENT 'y轴坐标',
  `node_type` varchar(20) COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT '节点类型',
  `node_action` text COLLATE utf8mb4_unicode_ci,
  `org_id` bigint(20) DEFAULT NULL COMMENT '企业id',
  `cluster_id` bigint(20) DEFAULT NULL COMMENT '集群id',
  `project_id` bigint(20) DEFAULT NULL COMMENT '项目id',
  `application_id` bigint(20) DEFAULT NULL COMMENT '应用id',
  `cluster_name` varchar(256) COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT '集群名',
  `persist_type` varchar(20) COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT '存储方式',
  `updated_at` datetime NOT NULL COMMENT '表记录创建时间',
  `creator_id` varchar(256) COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT '创建人id',
  PRIMARY KEY (`id`),
  KEY `workflow_id` (`workflow_id`),
  KEY `workflow_x_y` (`workflow_id`,`x`,`y`)
) ENGINE=InnoDB AUTO_INCREMENT=401 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='节点详情';

CREATE TABLE `fdp_agent_workflow_node_detail` (
  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '主键id',
  `workflow_id` bigint(20) NOT NULL COMMENT 'workflow id',
  `name` varchar(128) COLLATE utf8mb4_unicode_ci NOT NULL COMMENT '节点名称',
  `created_at` datetime NOT NULL COMMENT '表记录创建时间',
  `x` varchar(128) COLLATE utf8mb4_unicode_ci NOT NULL COMMENT 'x轴坐标',
  `y` varchar(128) COLLATE utf8mb4_unicode_ci NOT NULL COMMENT 'y轴坐标',
  `description` text COLLATE utf8mb4_unicode_ci COMMENT '节点描述',
  `node_type` varchar(20) COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT '节点类型',
  `tb_en_name` varchar(100) COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT '表英文名称',
  `tb_cn_name` varchar(100) COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT '表中文名称',
  `tb_desc` text COLLATE utf8mb4_unicode_ci COMMENT '表描述',
  `load_strategy` varchar(20) COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT '加载策略: increment/total',
  `jar_path` varchar(256) COLLATE utf8mb4_unicode_ci DEFAULT NULL,
  `node_id` bigint(20) DEFAULT NULL,
  `node_script` text COLLATE utf8mb4_unicode_ci COMMENT '自定义编辑内容',
  `main_model_id` bigint(20) DEFAULT NULL COMMENT '主模型 id',
  `main_model_alias` varchar(100) COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT '主模型别名',
  `main_model_filter_cond` text COLLATE utf8mb4_unicode_ci COMMENT '主模型过滤条件',
  `target_model_id` bigint(20) DEFAULT NULL COMMENT '目标模型 id',
  `target_model_alias` varchar(100) COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT '目标模型别名',
  `target_model_filter_cond` text COLLATE utf8mb4_unicode_ci COMMENT '目标模型过滤条件',
  `org_id` bigint(20) DEFAULT NULL COMMENT '企业id',
  `cluster_id` bigint(20) DEFAULT NULL COMMENT '集群id',
  `project_id` bigint(20) DEFAULT NULL COMMENT '项目id',
  `application_id` bigint(20) DEFAULT NULL COMMENT '应用id',
  `cluster_name` varchar(256) COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT '集群名',
  `creator_id` varchar(20) COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT '创建者id',
  `updated_at` datetime NOT NULL COMMENT '表记录创建时间',
  `node_extended` text COLLATE utf8mb4_unicode_ci COMMENT '其余信息',
  `script_path` varchar(256) COLLATE utf8mb4_unicode_ci DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `workflow_id` (`workflow_id`),
  KEY `workflow_x_y` (`workflow_id`,`x`,`y`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='节点详情';


CREATE TABLE `fdp_agent_data_audit` (
                                        `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '主键id',
                                        `data_model_id` bigint(20) NOT NULL COMMENT '数据模型ID',
                                        `apply_name` varchar(128) DEFAULT '' COMMENT '申请名称',
                                        `apply_reason` varchar(256) DEFAULT '' COMMENT '申请原因',
                                        `apply_type` varchar(256) DEFAULT '' COMMENT '申请类型',
                                        `apply_result` varchar(256) DEFAULT '' COMMENT '申请结果',
                                        `flow_id` varchar(256) DEFAULT NULL COMMENT '流程ID',
                                        `audit_user_name` varchar(256) DEFAULT NULL COMMENT '审批人',
                                        `creator_id` varchar(255) NOT NULL DEFAULT '' COMMENT '创建人 ID',
                                        `delete_yn` tinyint(1) NOT NULL DEFAULT '0' COMMENT '逻辑删除标记',
                                        `created_at` datetime NOT NULL COMMENT '表记录创建时间',
                                        `updated_at` datetime NOT NULL COMMENT '表记录更新时间',
                                        `cluster_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                        `project_id` bigint(20) DEFAULT '1' COMMENT '项目id',
                                        `org_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                        `application_id` bigint(20) DEFAULT NULL COMMENT '应用id',
                                        `cluster_name` varchar(256) DEFAULT '' COMMENT '集群名称',
                                        PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='创建审批记录表';

CREATE TABLE `fdp_agent_data_auth` (
                                       `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '主键id',
                                       `data_model_id` bigint(20) NOT NULL COMMENT '数据模型ID',
                                       `apply_name` varchar(128) DEFAULT '' COMMENT '申请名称',
                                       `apply_user_id` varchar(128) DEFAULT '' COMMENT '申请人ID',
                                       `apply_user_name` varchar(256) DEFAULT '' COMMENT '申请人姓名',
                                       `apply_type` varchar(64) DEFAULT '' COMMENT '申请类型',
                                       `apply_time` datetime NOT NULL COMMENT '申请时间',
                                       `audit_status` varchar(128) NOT NULL DEFAULT '' COMMENT '审批状态',
                                       `last_audit_time` datetime DEFAULT NULL COMMENT '最后审批时间',
                                       `remark` text COMMENT '拒绝理由',
                                       `creator_id` varchar(255) NOT NULL DEFAULT '' COMMENT '创建人 ID',
                                       `delete_yn` tinyint(1) NOT NULL DEFAULT '0' COMMENT '逻辑删除标记',
                                       `created_at` datetime NOT NULL COMMENT '表记录创建时间',
                                       `updated_at` datetime NOT NULL COMMENT '表记录更新时间',
                                       `cluster_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                       `project_id` bigint(20) DEFAULT '1' COMMENT '项目id',
                                       `org_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                       `application_id` bigint(20) DEFAULT NULL COMMENT '应用id',
                                       `cluster_name` varchar(256) DEFAULT '' COMMENT '集群名称',
                                       PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='审批授权表';

CREATE TABLE `fdp_agent_data_catalog` (
                                          `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '主键id',
                                          `name` varchar(128) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '目录名',
                                          `name_pinyin` varchar(128) CHARACTER SET latin1 NOT NULL DEFAULT '' COMMENT '目录拼音',
                                          `parent_id` bigint(20) NOT NULL COMMENT '上级目录id',
                                          `creator_id` varchar(256) CHARACTER SET latin1 NOT NULL DEFAULT '' COMMENT '创建人',
                                          `updater_id` varchar(256) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '修改人',
                                          `created_at` datetime NOT NULL COMMENT '表记录创建时间',
                                          `updated_at` datetime NOT NULL COMMENT '表记录更新时间',
                                          `cluster_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                          `project_id` bigint(20) DEFAULT '1' COMMENT '项目id',
                                          `org_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                          `application_id` bigint(20) DEFAULT NULL COMMENT '应用id',
                                          `cluster_name` varchar(256) COLLATE utf8mb4_unicode_ci DEFAULT '' COMMENT '集群名称',
                                          PRIMARY KEY (`id`),
                                          UNIQUE KEY `idx_parent_id_name` (`name`,`parent_id`,`project_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='数据目录表';

CREATE TABLE `fdp_agent_data_catalog_dependence` (
                                                     `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '主键id',
                                                     `source` varchar(64) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '平台来源：DL/CDP',
                                                     `type_in_cdp` varchar(64) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '数据模型在 CDP 下的类型：ods, dim, dwd, dws, ads',
                                                     `name` varchar(128) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '数据模型名称，在一个 source 下 name 需要唯一',
                                                     `description` varchar(1024) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '数据模型描述',
                                                     `data_source_id` bigint(20) NOT NULL COMMENT '数据源 ID',
                                                     `data_source_category` varchar(1024) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '数据源分类: INTERNAL, EXTERNAL',
                                                     `model_type` varchar(64) COLLATE utf8mb4_unicode_ci DEFAULT '' COMMENT '模型类型：BATCH/STREAMING',
                                                     `file_source_id` bigint(20) DEFAULT NULL COMMENT '文件名规则 ID',
                                                     `creator_id` varchar(256) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '创建人 ID',
                                                     `features` text COLLATE utf8mb4_unicode_ci NOT NULL COMMENT '额外信息',
                                                     `delete_yn` tinyint(1) NOT NULL DEFAULT '0' COMMENT '逻辑删除标记',
                                                     `created_at` datetime NOT NULL COMMENT '表记录创建时间',
                                                     `updated_at` datetime NOT NULL COMMENT '表记录更新时间',
                                                     `data_catalog_id` bigint(20) NOT NULL DEFAULT '0' COMMENT '数据目录ID',
                                                     `label0` bigint(20) NOT NULL DEFAULT '0' COMMENT '标签 ID',
                                                     `label1` bigint(20) NOT NULL DEFAULT '0' COMMENT '标签 ID',
                                                     `label2` bigint(20) NOT NULL DEFAULT '0' COMMENT '标签 ID',
                                                     `label3` bigint(20) NOT NULL DEFAULT '0' COMMENT '标签 ID',
                                                     `label4` bigint(20) NOT NULL DEFAULT '0' COMMENT '标签 ID',
                                                     `label5` bigint(20) NOT NULL DEFAULT '0' COMMENT '标签 ID',
                                                     `label6` bigint(20) NOT NULL DEFAULT '0' COMMENT '标签 ID',
                                                     `label7` bigint(20) NOT NULL DEFAULT '0' COMMENT '标签 ID',
                                                     `label8` bigint(20) NOT NULL DEFAULT '0' COMMENT '标签 ID',
                                                     `label9` bigint(20) NOT NULL DEFAULT '0' COMMENT '标签 ID',
                                                     `cluster_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                                     `project_id` bigint(20) DEFAULT '1' COMMENT '项目id',
                                                     `org_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                                     `application_id` bigint(20) DEFAULT NULL COMMENT '应用id',
                                                     `cluster_name` varchar(256) COLLATE utf8mb4_unicode_ci DEFAULT '' COMMENT '集群名称',
                                                     PRIMARY KEY (`id`),
                                                     UNIQUE KEY `idx_model_name_under_source` (`data_source_id`,`name`,`project_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='数据目录依赖表';

CREATE TABLE `fdp_agent_data_model_metadata` (
                                                 `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '主键id',
                                                 `data_model_id` bigint(20) NOT NULL DEFAULT '0' COMMENT '关联的数据模型 ID',
                                                 `seq_in_model` int(11) NOT NULL COMMENT '字段在模型中的顺序',
                                                 `column_name` varchar(128) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '字段名',
                                                 `column_type` varchar(128) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '字段类型',
                                                 `column_length` int(11) NOT NULL DEFAULT '-1' COMMENT '字段长度',
                                                 `column_comment` varchar(1024) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '字段说明',
                                                 `is_primary_key` tinyint(1) NOT NULL DEFAULT '0' COMMENT '字段是否是主键',
                                                 `allow_nullable` tinyint(1) NOT NULL DEFAULT '0' COMMENT '字段是否允许为空',
                                                 `is_partition_key` tinyint(1) NOT NULL DEFAULT '0' COMMENT '字段是否是分区键',
                                                 `creator_id` varchar(128) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '创建者 ID',
                                                 `updater_id` varchar(128) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '更新者 ID',
                                                 `quality_rules_ids` varchar(256) COLLATE utf8mb4_unicode_ci DEFAULT '' COMMENT '数据质量规则ID',
                                                 `created_at` datetime NOT NULL COMMENT '创建时间',
                                                 `updated_at` datetime NOT NULL COMMENT '更新时间',
                                                 `is_encrypted` tinyint(1) NOT NULL DEFAULT '0' COMMENT '是否加密 0否 1是',
                                                 `sensitive_rule_id` varchar(20) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '0' COMMENT '脱敏规>则id',
                                                 `is_pii` tinyint(1) NOT NULL DEFAULT '0' COMMENT '是否为pii数据 0否 1是',
                                                 `cluster_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                                 `project_id` bigint(20) DEFAULT '1' COMMENT '项目id',
                                                 `org_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                                 `application_id` bigint(20) DEFAULT NULL COMMENT '应用id',
                                                 `cluster_name` varchar(256) COLLATE utf8mb4_unicode_ci DEFAULT '' COMMENT '集群名称',
                                                 PRIMARY KEY (`id`),
                                                 UNIQUE KEY `uk_model_column_name` (`data_model_id`,`column_name`,`project_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='数据模型元数据表';

CREATE TABLE `fdp_agent_data_model_metadata_rel_quality` (
                                                             `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '主键id',
                                                             `metadata_id` bigint(20) NOT NULL COMMENT '字段ID',
                                                             `model_id` bigint(20) NOT NULL COMMENT '数据模型 id',
                                                             `quality_id` bigint(20) NOT NULL COMMENT '数据质量ID',
                                                             `created_at` datetime NOT NULL COMMENT '表记录创建时间',
                                                             `updated_at` datetime NOT NULL COMMENT '表记录更新时间',
                                                             `cluster_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                                             `project_id` bigint(20) DEFAULT '1' COMMENT '项目id',
                                                             `org_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                                             `application_id` bigint(20) DEFAULT NULL COMMENT '应用id',
                                                             `cluster_name` varchar(256) COLLATE utf8mb4_unicode_ci DEFAULT '' COMMENT '集群名称',
                                                             PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='数据模型元数据质量关联表';

CREATE TABLE `fdp_agent_data_models` (
                                         `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '主键id',
                                         `source` varchar(64) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '平台来源：DL/CDP',
                                         `type_in_cdp` varchar(64) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '数据模型在 CDP 下的类型：ods, dim, dwd, dws, ads',
                                         `name` varchar(128) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '数据模型名称，在一个 source 下 name 需要唯一',
                                         `description` varchar(1024) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '数据模型描述',
                                         `data_source_id` bigint(20) NOT NULL COMMENT '数据源 ID',
                                         `data_source_category` varchar(1024) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '数据源分类: INTERNAL, EXTERNAL',
                                         `model_type` varchar(64) COLLATE utf8mb4_unicode_ci DEFAULT '' COMMENT '模型类型：BATCH/STREAMING',
                                         `file_source_id` bigint(20) DEFAULT NULL COMMENT '文件名规则 ID',
                                         `creator_id` varchar(256) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '创建人 ID',
                                         `features` text COLLATE utf8mb4_unicode_ci NOT NULL COMMENT '额外信息',
                                         `delete_yn` tinyint(1) NOT NULL DEFAULT '0' COMMENT '逻辑删除标记',
                                         `created_at` datetime NOT NULL COMMENT '表记录创建时间',
                                         `updated_at` datetime NOT NULL COMMENT '表记录更新时间',
                                         `label0` bigint(20) NOT NULL DEFAULT '0' COMMENT '标签 ID',
                                         `label1` bigint(20) NOT NULL DEFAULT '0' COMMENT '标签 ID',
                                         `label2` bigint(20) NOT NULL DEFAULT '0' COMMENT '标签 ID',
                                         `label3` bigint(20) NOT NULL DEFAULT '0' COMMENT '标签 ID',
                                         `label4` bigint(20) NOT NULL DEFAULT '0' COMMENT '标签 ID',
                                         `label5` bigint(20) NOT NULL DEFAULT '0' COMMENT '标签 ID',
                                         `label6` bigint(20) NOT NULL DEFAULT '0' COMMENT '标签 ID',
                                         `label7` bigint(20) NOT NULL DEFAULT '0' COMMENT '标签 ID',
                                         `label8` bigint(20) NOT NULL DEFAULT '0' COMMENT '标签 ID',
                                         `label9` bigint(20) NOT NULL DEFAULT '0' COMMENT '标签 ID',
                                         `data_catalog_id` bigint(20) DEFAULT '0' COMMENT '数据目录id',
                                         `subject_id` bigint(20) DEFAULT NULL COMMENT '主题域id',
                                         `is_physical` tinyint(1) DEFAULT NULL COMMENT '物理化标识',
                                         `cluster_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                         `project_id` bigint(20) DEFAULT '1' COMMENT '项目id',
                                         `org_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                         `application_id` bigint(20) DEFAULT NULL COMMENT '应用id',
                                         `cluster_name` varchar(256) COLLATE utf8mb4_unicode_ci DEFAULT '' COMMENT '集群名称',
                                         PRIMARY KEY (`id`),
                                         UNIQUE KEY `idx_model_name_under_source` (`data_source_id`,`name`,`delete_yn`,`project_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='数据模型表';

CREATE TABLE `fdp_agent_data_service_generate_api_config` (
                                                              `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '主键id',
                                                              `org_id` bigint(20) DEFAULT NULL COMMENT '企业 id',
                                                              `api_name` varchar(64) NOT NULL COMMENT 'api 名称',
                                                              `api_path` varchar(128) NOT NULL COMMENT 'api 路径',
                                                              `request_type` varchar(32) NOT NULL COMMENT '请求方式：GET/POST/PUT/DELETE',
                                                              `response_type` varchar(32) NOT NULL COMMENT '返回类型: 目前只支持JSON',
                                                              `description` varchar(1024) DEFAULT NULL COMMENT '描述',
                                                              `data_source_type` varchar(32) NOT NULL COMMENT '数据源类型: MYSQL/CASSANDRA',
                                                              `data_source_name` varchar(128) NOT NULL COMMENT '数据源名称',
                                                              `data_model_name` varchar(128) DEFAULT NULL COMMENT '数据表名称',
                                                              `user_define_sql` text COMMENT '用户自定义sql',
                                                              `request_params` text COMMENT '生成API 请求参数',
                                                              `response_params` text COMMENT '生成API 返回参数',
                                                              `is_paging` tinyint(1) DEFAULT '0' COMMENT '是否分页',
                                                              `compute_engine` varchar(32) DEFAULT NULL COMMENT '计算引擎',
                                                              `publish_status` varchar(32) DEFAULT NULL COMMENT '发布状态',
                                                              `package_id` varchar(256) DEFAULT '' COMMENT '流量包id',
                                                              `bind_domain` varchar(256) DEFAULT '' COMMENT '绑定域名',
                                                              `api_call_times` bigint(20) DEFAULT NULL COMMENT 'api调用次数',
                                                              `delete_yn` tinyint(1) NOT NULL DEFAULT '0' COMMENT '逻辑删除标记',
                                                              `creator_id` varchar(128) DEFAULT NULL COMMENT '创建人 ID',
                                                              `updater_id` varchar(128) DEFAULT NULL COMMENT '更新者ID',
                                                              `created_at` datetime NOT NULL COMMENT '创建时间',
                                                              `updated_at` datetime NOT NULL COMMENT '更新时间',
                                                              `cluster_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                                              `project_id` bigint(20) DEFAULT '1' COMMENT '项目id',
                                                              `application_id` bigint(20) DEFAULT NULL COMMENT '应用id',
                                                              `cluster_name` varchar(256) DEFAULT '' COMMENT '集群名称',
                                                              PRIMARY KEY (`id`),
                                                              KEY `key_api_path` (`api_path`),
                                                              KEY `key_api_name` (`api_name`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='Api配置表';

CREATE TABLE `fdp_agent_data_sources` (
                                          `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '主键id',
                                          `org_id` bigint(20) DEFAULT NULL COMMENT '组织 ID',
                                          `name` varchar(128) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '数据源名称',
                                          `description` varchar(1024) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '数据源描述',
                                          `source` varchar(64) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '数据源来源: DL, CDP',
                                          `category` varchar(1024) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '数据源分类: INTERNAL, EXTERNAL',
                                          `type` varchar(64) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '数据源类型: MYSQL, FILE, SFTP, API',
                                          `host` varchar(1024) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '数据源连接地址',
                                          `port` varchar(64) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '连接端口',
                                          `db` varchar(256) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '数据库',
                                          `user` varchar(256) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '用户名',
                                          `pass` varchar(256) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '密码',
                                          `endpoint` varchar(1024) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT 'API 连接终端地址',
                                          `app_key` varchar(64) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT 'API key',
                                          `app_secret` varchar(256) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT 'API secret',
                                          `public_key` text COLLATE utf8mb4_unicode_ci COMMENT '公钥',
                                          `private_key` text COLLATE utf8mb4_unicode_ci COMMENT '私钥',
                                          `file_source_id` bigint(20) NOT NULL DEFAULT '0' COMMENT '文件来源 ID',
                                          `creator_id` varchar(256) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '创建人 ID',
                                          `delete_yn` tinyint(1) NOT NULL DEFAULT '0' COMMENT '逻辑删除标记',
                                          `created_at` datetime NOT NULL COMMENT '表记录创建时间',
                                          `updated_at` datetime NOT NULL COMMENT '表记录更新时间',
                                          `label0` bigint(20) NOT NULL DEFAULT '0' COMMENT '标签 ID',
                                          `label1` bigint(20) NOT NULL DEFAULT '0' COMMENT '标签 ID',
                                          `label2` bigint(20) NOT NULL DEFAULT '0' COMMENT '标签 ID',
                                          `label3` bigint(20) NOT NULL DEFAULT '0' COMMENT '标签 ID',
                                          `label4` bigint(20) NOT NULL DEFAULT '0' COMMENT '标签 ID',
                                          `label5` bigint(20) NOT NULL DEFAULT '0' COMMENT '标签 ID',
                                          `label6` bigint(20) NOT NULL DEFAULT '0' COMMENT '标签 ID',
                                          `label7` bigint(20) NOT NULL DEFAULT '0' COMMENT '标签 ID',
                                          `label8` bigint(20) NOT NULL DEFAULT '0' COMMENT '标签 ID',
                                          `label9` bigint(20) NOT NULL DEFAULT '0' COMMENT '标签 ID',
                                          `cluster_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                          `project_id` bigint(20) DEFAULT '1' COMMENT '项目id',
                                          `application_id` bigint(20) DEFAULT NULL COMMENT '应用id',
                                          `cluster_name` varchar(256) COLLATE utf8mb4_unicode_ci DEFAULT '' COMMENT '集群名称',
                                          PRIMARY KEY (`id`),
                                          UNIQUE KEY `idx_name` (`name`)
) ENGINE=InnoDB AUTO_INCREMENT=3 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='数据源表';

INSERT INTO `fdp_agent_data_sources` (`id`, `org_id`, `name`, `description`, `source`, `category`, `type`, `host`, `port`, `db`, `user`, `pass`, `endpoint`, `app_key`, `app_secret`, `public_key`, `private_key`, `file_source_id`, `creator_id`, `delete_yn`, `created_at`, `updated_at`, `label0`, `label1`, `label2`, `label3`, `label4`, `label5`, `label6`, `label7`, `label8`, `label9`, `cluster_id`, `project_id`, `application_id`, `cluster_name`) VALUES (1,NULL,'cassandra','','CDP','','CASSANDRA','addon-cassandra-dc1-rack1-0.addon-cassandra.default.svc.cluster.local','9042','cdp','hive','hive','','','',NULL,NULL,0,'',0,'2021-05-12 17:46:22','2021-05-12 17:46:22',0,0,0,0,0,0,0,0,0,0,NULL,1,NULL,''),(2,NULL,'spark','','CDP','','SPARK','spark-thrift-server-test.default.svc.cluster.local','10000','cdp','hive','hive','','','',NULL,NULL,0,'',0,'2021-05-12 17:46:22','2021-05-12 17:46:22',0,0,0,0,0,0,0,0,0,0,NULL,1,NULL,'');

CREATE TABLE `fdp_agent_dl_data_application` (
                                                 `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '主键id',
                                                 `source` varchar(64) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '平台来源：DL/CDP',
                                                 `apply_name` varchar(64) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '申请名称',
                                                 `apply_type` varchar(64) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '申请类型:DELETE/UPDATE/EXPORT',
                                                 `apply_sql` text COLLATE utf8mb4_unicode_ci NOT NULL COMMENT '相关sql',
                                                 `data_source_id` bigint(20) NOT NULL COMMENT '数据源 ID',
                                                 `expect_affected_lines` bigint(20) NOT NULL COMMENT '预计影响行数',
                                                 `apply_reason` text COLLATE utf8mb4_unicode_ci NOT NULL COMMENT '申请原因',
                                                 `apply_result` varchar(64) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '申请结果: BE_AUDITED/PASSED/REJECTED',
                                                 `execute_status` varchar(64) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '执行状态 WAIT_START/RUNNING/SUCCESS/FAILED',
                                                 `execute_result` text COLLATE utf8mb4_unicode_ci NOT NULL COMMENT '执行结果',
                                                 `flow_id` varchar(256) COLLATE utf8mb4_unicode_ci DEFAULT '' COMMENT '审批流程ID',
                                                 `attachments` text COLLATE utf8mb4_unicode_ci COMMENT '附件信息',
                                                 `creator_id` varchar(255) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '创建人 ID',
                                                 `created_at` datetime NOT NULL COMMENT '表记录创建时间',
                                                 `updated_at` datetime NOT NULL COMMENT '表记录更新时间',
                                                 `cluster_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                                 `project_id` bigint(20) DEFAULT '1' COMMENT '项目id',
                                                 `org_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                                 `application_id` bigint(20) DEFAULT NULL COMMENT '应用id',
                                                 `cluster_name` varchar(256) COLLATE utf8mb4_unicode_ci DEFAULT '' COMMENT '集群名称',
                                                 PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='数据应用申请表';

CREATE TABLE `fdp_agent_dl_data_model_indexes` (
                                                   `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '主键id',
                                                   `data_model_id` bigint(20) NOT NULL COMMENT '关联的数据模型 ID',
                                                   `index_name` varchar(255) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '索引名',
                                                   `index_column` varchar(128) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '索引字段名',
                                                   `is_unique` tinyint(1) NOT NULL COMMENT '是否是唯一索引',
                                                   `seq_in_index` int(11) NOT NULL COMMENT '字段在联合索引中的顺序',
                                                   `creator_id` varchar(128) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '创建者 ID',
                                                   `updater_id` varchar(128) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '更新者 ID',
                                                   `created_at` datetime NOT NULL COMMENT '创建时间',
                                                   `updated_at` datetime NOT NULL COMMENT '更新时间',
                                                   `cluster_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                                   `project_id` bigint(20) DEFAULT '1' COMMENT '项目id',
                                                   `org_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                                   `application_id` bigint(20) DEFAULT NULL COMMENT '应用id',
                                                   `cluster_name` varchar(256) COLLATE utf8mb4_unicode_ci DEFAULT '' COMMENT '集群名称',
                                                   PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='数据模型索引表';

CREATE TABLE `fdp_agent_dl_data_model_metadata` (
                                                    `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '主键id',
                                                    `data_model_id` bigint(20) NOT NULL DEFAULT '0' COMMENT '关联的数据模型 ID',
                                                    `seq_in_model` int(11) NOT NULL DEFAULT '0' COMMENT '字段在模型中的顺序',
                                                    `column_name` varchar(128) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '字段名',
                                                    `column_type` varchar(128) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '字段类型',
                                                    `column_length` int(11) NOT NULL DEFAULT '-1' COMMENT '字段长度',
                                                    `column_comment` varchar(1024) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '字段说明',
                                                    `is_primary_key` tinyint(1) NOT NULL DEFAULT '0' COMMENT '字段是否是主键',
                                                    `allow_nullable` tinyint(1) NOT NULL DEFAULT '0' COMMENT '字段是否允许为空',
                                                    `is_partition_key` tinyint(1) NOT NULL DEFAULT '0' COMMENT '字段是否是分区键',
                                                    `column_default` varchar(1024) COLLATE utf8mb4_unicode_ci DEFAULT '' COMMENT '字段默认值',
                                                    `column_extra` varchar(1024) COLLATE utf8mb4_unicode_ci DEFAULT '' COMMENT '字段额外信息',
                                                    `creator_id` varchar(128) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '创建者 ID',
                                                    `updater_id` varchar(128) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '更新者 ID',
                                                    `created_at` datetime NOT NULL COMMENT '创建时间',
                                                    `updated_at` datetime NOT NULL COMMENT '更新时间',
                                                    `is_encrypted` tinyint(1) NOT NULL DEFAULT '0' COMMENT '是否加密 0否 1是',
                                                    `sensitive_rule_id` varchar(20) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '0' COMMENT '脱敏规则id',
                                                    `is_pii` tinyint(1) NOT NULL DEFAULT '0' COMMENT '是否为pii数据 0否 1是',
                                                    `cluster_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                                    `project_id` bigint(20) DEFAULT '1' COMMENT '项目id',
                                                    `org_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                                    `application_id` bigint(20) DEFAULT NULL COMMENT '应用id',
                                                    `cluster_name` varchar(256) COLLATE utf8mb4_unicode_ci DEFAULT '' COMMENT '集群名称',
                                                    PRIMARY KEY (`id`),
                                                    UNIQUE KEY `uk_model_column_name` (`data_model_id`,`column_name`,`project_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='数据模型元数据表';

CREATE TABLE `fdp_agent_dl_data_model_sensitive_rule` (
                                                          `id` bigint(20) NOT NULL COMMENT '主键id',
                                                          `name` varchar(255) COLLATE utf8mb4_unicode_ci NOT NULL COMMENT '脱敏名称',
                                                          `describe` varchar(255) COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT '描述',
                                                          `seq` int(11) NOT NULL COMMENT '序号',
                                                          `regex` varchar(255) COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT '正则匹配',
                                                          `replacement` varchar(255) COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT '替换规则',
                                                          `tenant_id` bigint(20) DEFAULT NULL COMMENT '商户id',
                                                          `delete_yn` tinyint(1) NOT NULL DEFAULT '0' COMMENT '删除标记 0:未删除 1:已删除',
                                                          `cluster_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                                          `project_id` bigint(20) DEFAULT '1' COMMENT '项目id',
                                                          `org_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                                          `application_id` bigint(20) DEFAULT NULL COMMENT '应用id',
                                                          `cluster_name` varchar(256) COLLATE utf8mb4_unicode_ci DEFAULT '' COMMENT '集群名称',
                                                          PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='脱敏规则表';

INSERT INTO `fdp_agent_dl_data_model_sensitive_rule` (`id`, `name`, `describe`, `seq`, `regex`, `replacement`, `tenant_id`, `delete_yn`, `cluster_id`, `project_id`, `org_id`, `application_id`, `cluster_name`) VALUES (0,'不脱敏','不脱敏',0,NULL,NULL,NULL,0,NULL,1,NULL,NULL,''),(1,'中文姓名','保留首尾两个汉字，其他用星号代替。如果只有两个汉字，则最后一位用星号代替',1,'(\\S)(\\S)(\\S{0,10})','$1*$3',NULL,0,NULL,1,NULL,NULL,''),(2,'身份证号','显示最后四位，其他隐藏。共计18位或者15位，比如：*************1234',2,'(.*)(.{4})','**************$2',NULL,0,NULL,1,NULL,NULL,''),(3,'电话','前三位，后四位，其他隐藏，比如：135****6810',3,'(.{3})(.*)(.{4})','$1********$2',NULL,0,NULL,1,NULL,NULL,''),(4,'家庭住址','只显示到地区，不显示详细地址，比如：上海徐汇区漕河泾开发区***',4,'(\\S+)(\\u533a|\\u53bf|\\u9547|\\u4e61)(\\S+)','$1$2******',NULL,0,NULL,1,NULL,NULL,''),(5,'银行卡号','前六位，后四位，其他用星号隐藏每位1个星号，比如：622260**********1234',5,'(.{6})(.*)(.{4})','$1********$3',NULL,0,NULL,1,NULL,NULL,''),(6,'密码','密码的全部字符都用*代替，比如：******',6,'\\S+','********',NULL,0,NULL,1,NULL,NULL,''),(7,'邮箱','邮箱前缀仅显示第一个字母，前缀其他隐藏，用星号代替，@及后面的地址显示',7,'(\\w)(\\w+)@(\\w+)','$1***@$3',NULL,0,NULL,1,NULL,NULL,''),(8,'通用规则','仅保留第一个与最后一个字符，其余全部***',8,'(.{1})(.*)(.{1})','$1********$3',NULL,0,NULL,1,NULL,NULL,'');

CREATE TABLE `fdp_agent_dl_data_models` (
                                            `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '主键id',
                                            `source` varchar(64) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '平台来源：DL/CDP',
                                            `type_in_cdp` varchar(64) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '数据模型在 CDP 下的类型：ods, dim, dwd, dws, ads',
                                            `name` varchar(128) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '数据模型名称，在一个 source 下 name 需要唯一',
                                            `description` varchar(1024) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '数据模型描述',
                                            `data_source_id` bigint(20) NOT NULL COMMENT '数据源 ID',
                                            `data_source_category` varchar(1024) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '数据源分类: INTERNAL, EXTERNAL',
                                            `file_source_id` bigint(20) DEFAULT NULL COMMENT '文件名规则 ID',
                                            `creator_id` varchar(256) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '创建人 ID',
                                            `features` text COLLATE utf8mb4_unicode_ci NOT NULL COMMENT '额外信息',
                                            `delete_yn` tinyint(1) NOT NULL DEFAULT '0' COMMENT '逻辑删除标记',
                                            `delete_duration` bigint(20) DEFAULT NULL COMMENT '删除时长',
                                            `created_at` datetime NOT NULL COMMENT '表记录创建时间',
                                            `updated_at` datetime NOT NULL COMMENT '表记录更新时间',
                                            `label0` bigint(20) NOT NULL DEFAULT '0' COMMENT '标签 ID',
                                            `label1` bigint(20) NOT NULL DEFAULT '0' COMMENT '标签 ID',
                                            `label2` bigint(20) NOT NULL DEFAULT '0' COMMENT '标签 ID',
                                            `label3` bigint(20) NOT NULL DEFAULT '0' COMMENT '标签 ID',
                                            `label4` bigint(20) NOT NULL DEFAULT '0' COMMENT '标签 ID',
                                            `label5` bigint(20) NOT NULL DEFAULT '0' COMMENT '标签 ID',
                                            `label6` bigint(20) NOT NULL DEFAULT '0' COMMENT '标签 ID',
                                            `label7` bigint(20) NOT NULL DEFAULT '0' COMMENT '标签 ID',
                                            `label8` bigint(20) NOT NULL DEFAULT '0' COMMENT '标签 ID',
                                            `label9` bigint(20) NOT NULL DEFAULT '0' COMMENT '标签 ID',
                                            `cluster_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                            `project_id` bigint(20) DEFAULT '1' COMMENT '项目id',
                                            `org_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                            `application_id` bigint(20) DEFAULT NULL COMMENT '应用id',
                                            `cluster_name` varchar(256) COLLATE utf8mb4_unicode_ci DEFAULT '' COMMENT '集群名称',
                                            PRIMARY KEY (`id`),
                                            UNIQUE KEY `idx_model_name_under_source` (`data_source_id`,`name`,`delete_yn`,`project_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='数据模型表';

CREATE TABLE `fdp_agent_dl_data_models_config` (
                                                   `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '主键id',
                                                   `data_model_id` bigint(20) NOT NULL COMMENT '关联的数据模型 ID',
                                                   `delete_yn` tinyint(1) NOT NULL DEFAULT '0' COMMENT '逻辑删除标记',
                                                   `creator_id` varchar(255) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '创建人 ID',
                                                   `updater_id` varchar(255) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '修改人 ID',
                                                   `created_at` datetime NOT NULL COMMENT '表记录创建时间',
                                                   `updated_at` datetime NOT NULL COMMENT '表记录更新时间',
                                                   `cluster_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                                   `project_id` bigint(20) DEFAULT '1' COMMENT '项目id',
                                                   `org_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                                   `application_id` bigint(20) DEFAULT NULL COMMENT '应用id',
                                                   `cluster_name` varchar(256) COLLATE utf8mb4_unicode_ci DEFAULT '' COMMENT '集群名称',
                                                   PRIMARY KEY (`id`),
                                                   KEY `indexs` (`data_model_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='数据模型配置表';

CREATE TABLE `fdp_agent_dl_data_models_statistics` (
                                                       `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '主键id',
                                                       `data_model_id` bigint(20) NOT NULL COMMENT '数据模型 ID',
                                                       `statistical_date` varchar(64) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '统计日期',
                                                       `data_model_volume` bigint(20) NOT NULL COMMENT '数据模型统计量',
                                                       `delete_yn` tinyint(1) NOT NULL DEFAULT '0' COMMENT '逻辑删除标记',
                                                       `created_at` datetime NOT NULL COMMENT '表记录创建时间',
                                                       `updated_at` datetime NOT NULL COMMENT '表记录更新时间',
                                                       `cluster_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                                       `project_id` bigint(20) DEFAULT '1' COMMENT '项目id',
                                                       `org_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                                       `application_id` bigint(20) DEFAULT NULL COMMENT '应用id',
                                                       `cluster_name` varchar(256) COLLATE utf8mb4_unicode_ci DEFAULT '' COMMENT '集群名称',
                                                       PRIMARY KEY (`id`),
                                                       UNIQUE KEY `uk_model_id_date` (`data_model_id`,`statistical_date`,`project_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='数据模型统计表';

CREATE TABLE `fdp_agent_dl_data_sources` (
                                             `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '主键id',
                                             `name` varchar(128) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '数据源名称',
                                             `description` varchar(1024) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '数据源描述',
                                             `source` varchar(64) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '数据源来源: DL, CDP',
                                             `category` varchar(1024) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '数据源分类: INTERNAL, EXTERNAL',
                                             `type` varchar(64) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '数据源类型: MYSQL, FILE, SFTP, API',
                                             `host` varchar(1024) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '数据源连接地址',
                                             `port` varchar(64) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '连接端口',
                                             `db` varchar(256) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '数据库',
                                             `user` varchar(256) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '用户名',
                                             `pass` varchar(256) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '密码',
                                             `endpoint` varchar(1024) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT 'API 连接终端地址',
                                             `app_key` varchar(64) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT 'API key',
                                             `app_secret` varchar(256) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT 'API secret',
                                             `public_key` text COLLATE utf8mb4_unicode_ci COMMENT '公钥',
                                             `private_key` text COLLATE utf8mb4_unicode_ci COMMENT '私钥',
                                             `server_id` varchar(256) COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT '服务器ID',
                                             `server_name` varchar(256) COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT '服务器名称',
                                             `file_source_id` bigint(20) NOT NULL DEFAULT '0' COMMENT '文件来源 ID',
                                             `creator_id` varchar(256) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '创建人 ID',
                                             `delete_yn` tinyint(1) NOT NULL DEFAULT '0' COMMENT '逻辑删除标记',
                                             `created_at` datetime NOT NULL COMMENT '表记录创建时间',
                                             `updated_at` datetime NOT NULL COMMENT '表记录更新时间',
                                             `label0` bigint(20) NOT NULL DEFAULT '0' COMMENT '标签 ID',
                                             `label1` bigint(20) NOT NULL DEFAULT '0' COMMENT '标签 ID',
                                             `label2` bigint(20) NOT NULL DEFAULT '0' COMMENT '标签 ID',
                                             `label3` bigint(20) NOT NULL DEFAULT '0' COMMENT '标签 ID',
                                             `label4` bigint(20) NOT NULL DEFAULT '0' COMMENT '标签 ID',
                                             `label5` bigint(20) NOT NULL DEFAULT '0' COMMENT '标签 ID',
                                             `label6` bigint(20) NOT NULL DEFAULT '0' COMMENT '标签 ID',
                                             `label7` bigint(20) NOT NULL DEFAULT '0' COMMENT '标签 ID',
                                             `label8` bigint(20) NOT NULL DEFAULT '0' COMMENT '标签 ID',
                                             `label9` bigint(20) NOT NULL DEFAULT '0' COMMENT '标签 ID',
                                             `custom` varchar(1024) COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT '额外配置',
                                             `cluster_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                             `project_id` bigint(20) DEFAULT '1' COMMENT '项目id',
                                             `org_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                             `application_id` bigint(20) DEFAULT NULL COMMENT '应用id',
                                             `cluster_name` varchar(256) COLLATE utf8mb4_unicode_ci DEFAULT '' COMMENT '集群名称',
                                             PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='数据源表';

CREATE TABLE `fdp_agent_dl_disks` (
                                      `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '主键id',
                                      `name` varchar(128) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '磁盘名',
                                      `name_pinyin` varchar(128) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '磁盘名拼音',
                                      `type` varchar(64) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '磁盘类型: SYSTEM, NORMAL',
                                      `creator_id` varchar(256) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '创建人 ID',
                                      `delete_yn` tinyint(1) NOT NULL DEFAULT '0' COMMENT '逻辑删除标记',
                                      `created_at` datetime NOT NULL COMMENT '表记录创建时间',
                                      `updated_at` datetime NOT NULL COMMENT '表记录更新时间',
                                      `cluster_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                      `project_id` bigint(20) DEFAULT '1' COMMENT '项目id',
                                      `org_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                      `application_id` bigint(20) DEFAULT NULL COMMENT '应用id',
                                      `cluster_name` varchar(256) COLLATE utf8mb4_unicode_ci DEFAULT '' COMMENT '集群名称',
                                      PRIMARY KEY (`id`),
                                      UNIQUE KEY `idx_name` (`name`)
) ENGINE=InnoDB AUTO_INCREMENT=3 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='磁盘表';

INSERT INTO `fdp_agent_dl_disks` (`id`, `name`, `name_pinyin`, `type`, `creator_id`, `delete_yn`, `created_at`, `updated_at`, `cluster_id`, `project_id`, `org_id`, `application_id`, `cluster_name`) VALUES (1,'System Files','System Files','SYSTEM','',0,'2019-09-19 11:44:56','2019-09-19 11:44:56',NULL,1,NULL,NULL,''),(2,'Files','Files','NORMAL','',0,'2019-09-19 11:44:56','2019-09-19 11:44:56',NULL,1,NULL,NULL,'');

CREATE TABLE `fdp_agent_dl_file_sources` (
                                             `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '主键id',
                                             `name` varchar(128) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '文件来源名',
                                             `creator_id` varchar(256) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '创建人 ID',
                                             `delete_yn` tinyint(1) NOT NULL DEFAULT '0' COMMENT '逻辑删除标记',
                                             `created_at` datetime NOT NULL COMMENT '表记录创建时间',
                                             `updated_at` datetime NOT NULL COMMENT '表记录更新时间',
                                             `cluster_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                             `project_id` bigint(20) DEFAULT '1' COMMENT '项目id',
                                             `org_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                             `application_id` bigint(20) DEFAULT NULL COMMENT '应用id',
                                             `cluster_name` varchar(256) COLLATE utf8mb4_unicode_ci DEFAULT '' COMMENT '集群名称',
                                             PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='文件来源表';

CREATE TABLE `fdp_agent_dl_file_upload_rules` (
                                                  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '主键id',
                                                  `type` varchar(64) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '文件上传规则类型',
                                                  `value` varchar(64) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '规则内容',
                                                  `creator_id` varchar(256) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '创建人 ID',
                                                  `delete_yn` tinyint(1) NOT NULL DEFAULT '0' COMMENT '逻辑删除标记',
                                                  `created_at` datetime NOT NULL COMMENT '表记录创建时间',
                                                  `updated_at` datetime NOT NULL COMMENT '表记录更新时间',
                                                  `cluster_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                                  `project_id` bigint(20) DEFAULT '1' COMMENT '项目id',
                                                  `org_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                                  `application_id` bigint(20) DEFAULT NULL COMMENT '应用id',
                                                  `cluster_name` varchar(256) COLLATE utf8mb4_unicode_ci DEFAULT '' COMMENT '集群名称',
                                                  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='文件上传规则表';

CREATE TABLE `fdp_agent_dl_files` (
                                      `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '主键id',
                                      `name` varchar(128) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '文件名',
                                      `name_pinyin` varchar(128) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '文件名拼音',
                                      `disk_id` bigint(20) NOT NULL COMMENT '磁盘 ID',
                                      `type` varchar(64) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '磁盘类型: SYSTEM, NORMAL',
                                      `folder_id` bigint(20) NOT NULL COMMENT '目录 ID',
                                      `url` varchar(1024) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '文件下载链接',
                                      `size` bigint(20) NOT NULL COMMENT '文件大小',
                                      `suffix` varchar(64) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '文件后缀',
                                      `creator_id` varchar(256) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '创建人 ID',
                                      `delete_yn` tinyint(1) NOT NULL DEFAULT '0' COMMENT '逻辑删除标记',
                                      `created_at` datetime NOT NULL COMMENT '表记录创建时间',
                                      `updated_at` datetime NOT NULL COMMENT '表记录更新时间',
                                      `cluster_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                      `project_id` bigint(20) DEFAULT '1' COMMENT '项目id',
                                      `org_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                      `application_id` bigint(20) DEFAULT NULL COMMENT '应用id',
                                      `cluster_name` varchar(256) COLLATE utf8mb4_unicode_ci DEFAULT '' COMMENT '集群名称',
                                      PRIMARY KEY (`id`),
                                      KEY `idx_disk_id_folder_id_name` (`disk_id`,`folder_id`,`name`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='文件表';

CREATE TABLE `fdp_agent_dl_labels` (
                                       `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '主键id',
                                       `name` varchar(64) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '标签名',
                                       `color` varchar(64) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '标签颜色',
                                       `module` varchar(64) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '标签所属模块: DATA_SOURCE, DATA_MODEL',
                                       `creator_id` varchar(256) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '创建人 ID',
                                       `delete_yn` tinyint(1) NOT NULL DEFAULT '0' COMMENT '逻辑删除标记',
                                       `created_at` datetime NOT NULL COMMENT '表记录创建时间',
                                       `updated_at` datetime NOT NULL COMMENT '表记录更新时间',
                                       `cluster_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                       `project_id` bigint(20) DEFAULT '1' COMMENT '项目id',
                                       `org_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                       `application_id` bigint(20) DEFAULT NULL COMMENT '应用id',
                                       `cluster_name` varchar(256) COLLATE utf8mb4_unicode_ci DEFAULT '' COMMENT '集群名称',
                                       PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='标签表';

CREATE TABLE `fdp_agent_dl_quality_rules` (
                                              `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '主键id',
                                              `name` varchar(64) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '规则名称',
                                              `rule_type` varchar(64) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '规则类型',
                                              `rule_desc` varchar(64) COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT '规则描述',
                                              `rule_content` varchar(64) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '规则内容',
                                              `creator_id` varchar(255) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '创建人 ID',
                                              `delete_yn` tinyint(1) NOT NULL DEFAULT '0' COMMENT '逻辑删除标记',
                                              `created_at` datetime NOT NULL COMMENT '表记录创建时间',
                                              `updated_at` datetime NOT NULL COMMENT '表记录更新时间',
                                              `cluster_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                              `project_id` bigint(20) DEFAULT '1' COMMENT '项目id',
                                              `org_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                              `application_id` bigint(20) DEFAULT NULL COMMENT '应用id',
                                              `cluster_name` varchar(256) COLLATE utf8mb4_unicode_ci DEFAULT '' COMMENT '集群名称',
                                              PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='质量规则表';

CREATE TABLE `fdp_agent_dl_sql_histories` (
                                              `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '主键id',
                                              `data_model_id` bigint(20) NOT NULL COMMENT '数据模型 ID',
                                              `name` varchar(256) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '执行记录名称',
                                              `sql` text COLLATE utf8mb4_unicode_ci NOT NULL COMMENT '执行的 SQL',
                                              `result` text COLLATE utf8mb4_unicode_ci NOT NULL COMMENT 'SQL 执行结果',
                                              `creator_id` varchar(256) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '创建人 ID',
                                              `created_at` datetime NOT NULL COMMENT '表记录创建时间',
                                              `updated_at` datetime NOT NULL COMMENT '表记录更新时间',
                                              `cluster_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                              `project_id` bigint(20) DEFAULT '1' COMMENT '项目id',
                                              `org_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                              `application_id` bigint(20) DEFAULT NULL COMMENT '应用id',
                                              `cluster_name` varchar(256) COLLATE utf8mb4_unicode_ci DEFAULT '' COMMENT '集群名称',
                                              PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='sql历史表';

CREATE TABLE `fdp_agent_dl_task_categories` (
                                                `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '主键id',
                                                `source` varchar(64) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '平台来源：DL/CDP',
                                                `name` varchar(128) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '目录名',
                                                `name_pinyin` varchar(128) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '目录名拼音',
                                                `parent_id` bigint(20) NOT NULL COMMENT '上级目录 ID',
                                                `creator_id` varchar(256) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '创建人 ID',
                                                `created_at` datetime NOT NULL COMMENT '表记录创建时间',
                                                `updated_at` datetime NOT NULL COMMENT '表记录更新时间',
                                                `cluster_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                                `project_id` bigint(20) DEFAULT '1' COMMENT '项目id',
                                                `org_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                                `application_id` bigint(20) DEFAULT NULL COMMENT '应用id',
                                                `cluster_name` varchar(256) COLLATE utf8mb4_unicode_ci DEFAULT '' COMMENT '集群名称',
                                                PRIMARY KEY (`id`),
                                                UNIQUE KEY `idx_parent_id_name` (`parent_id`,`source`,`name`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='任务目录表';

CREATE TABLE `fdp_agent_dl_task_runs` (
                                          `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '主键id',
                                          `task_def_id` bigint(20) NOT NULL COMMENT '任务定义 ID',
                                          `instance_id` bigint(20) NOT NULL COMMENT '任务实例 ID',
                                          `name` varchar(256) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '任务名',
                                          `name_pinyin` varchar(256) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '任务名拼音',
                                          `type` varchar(64) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '类型: 数据集成 Ingestion',
                                          `sync_type` varchar(64) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '同步类型: API 同步、文件同步',
                                          `run_type` varchar(64) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '运行类型: ONCE、CRON',
                                          `cron` varchar(128) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '任务周期',
                                          `from_data_model_id` bigint(20) NOT NULL COMMENT '模型同步来源：数据模型 ID',
                                          `to_data_model_id` bigint(20) NOT NULL COMMENT '模型同步目标：数据模型 ID',
                                          `status` varchar(64) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '任务执行状态',
                                          `success_count` int(11) NOT NULL DEFAULT '0' COMMENT '成功数',
                                          `failure_count` int(11) NOT NULL DEFAULT '0' COMMENT '失败数',
                                          `total_count` int(11) NOT NULL DEFAULT '0' COMMENT '总数',
                                          `link` varchar(1024) COLLATE utf8mb4_unicode_ci NOT NULL COMMENT '错误内容文本(TXT/JSON)的地址',
                                          `creator_id` varchar(256) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '创建者 ID',
                                          `features` text COLLATE utf8mb4_unicode_ci NOT NULL COMMENT '额外信息',
                                          `started_at` datetime DEFAULT NULL COMMENT '任务实例开始时间',
                                          `ended_at` datetime DEFAULT NULL COMMENT '任务实例结束时间',
                                          `created_at` datetime NOT NULL COMMENT '表记录创建时间',
                                          `updated_at` datetime NOT NULL COMMENT '表记录更新时间',
                                          `cluster_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                          `project_id` bigint(20) DEFAULT '1' COMMENT '项目id',
                                          `org_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                          `application_id` bigint(20) DEFAULT NULL COMMENT '应用id',
                                          `cluster_name` varchar(256) COLLATE utf8mb4_unicode_ci DEFAULT '' COMMENT '集群名称',
                                          PRIMARY KEY (`id`),
                                          UNIQUE KEY `uk_task_def_id_instance_id` (`task_def_id`,`instance_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='任务运行记录表';

CREATE TABLE `fdp_agent_dl_tasks` (
                                      `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '主键id',
                                      `name` varchar(128) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '任务名',
                                      `name_pinyin` varchar(256) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '任务名拼音',
                                      `description` varchar(256) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '任务描述',
                                      `category_id` bigint(20) NOT NULL COMMENT '任务目录 ID',
                                      `type` varchar(64) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '类型: 数据集成 Ingestion',
                                      `sync_type` varchar(64) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '同步类型: API 同步、文件同步',
                                      `run_type` varchar(64) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '运行类型: ONCE、CRON',
                                      `cron` varchar(128) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '任务周期',
                                      `from_data_model_id` bigint(20) NOT NULL COMMENT '模型同步来源：数据模型 ID',
                                      `to_data_model_id` bigint(20) NOT NULL COMMENT '模型同步目标：数据模型 ID',
                                      `creator_id` varchar(256) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '创建者 ID',
                                      `updater_id` varchar(256) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '修改者 ID',
                                      `features` text COLLATE utf8mb4_unicode_ci NOT NULL COMMENT '额外信息',
                                      `created_at` datetime NOT NULL COMMENT '表记录创建时间',
                                      `updated_at` datetime NOT NULL COMMENT '表记录更新时间',
                                      `update_field` varchar(64) CHARACTER SET utf8 COLLATE utf8_unicode_ci DEFAULT '' COMMENT '时间更新字段',
                                      `cluster_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                      `project_id` bigint(20) DEFAULT '1' COMMENT '项目id',
                                      `org_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                      `application_id` bigint(20) DEFAULT NULL COMMENT '应用id',
                                      `cluster_name` varchar(256) COLLATE utf8mb4_unicode_ci DEFAULT '' COMMENT '集群名称',
                                      PRIMARY KEY (`id`),
                                      UNIQUE KEY `uk_category_id_name` (`category_id`,`name`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='任务表';

CREATE TABLE `fdp_agent_indicators` (
                                        `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '主键id',
                                        `workflow_id` bigint(20) NOT NULL COMMENT '工作流Id',
                                        `workflow_name` varchar(128) COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT '工作流名称',
                                        `name` varchar(128) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '指标名称',
                                        `table_id` bigint(20) DEFAULT NULL COMMENT '模型Id',
                                        `table_name` varchar(128) COLLATE utf8mb4_unicode_ci NOT NULL COMMENT '表名称',
                                        `field_name` varchar(128) COLLATE utf8mb4_unicode_ci NOT NULL COMMENT '表字段名称',
                                        `created_at` datetime NOT NULL COMMENT '表记录创建时间',
                                        `updated_at` datetime NOT NULL COMMENT '表记录更新时间',
                                        `cluster_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                        `project_id` bigint(20) DEFAULT '1' COMMENT '项目id',
                                        `org_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                        `application_id` bigint(20) DEFAULT NULL COMMENT '应用id',
                                        `cluster_name` varchar(256) COLLATE utf8mb4_unicode_ci DEFAULT '' COMMENT '集群名称',
                                        PRIMARY KEY (`id`),
                                        UNIQUE KEY `idx_name` (`name`,`project_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='指标表';

CREATE TABLE `fdp_agent_labels` (
                                    `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '主键id',
                                    `name` varchar(64) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '标签名',
                                    `color` varchar(64) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '标签颜色',
                                    `module` varchar(64) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '标签所属模块: DATA_SOURCE, DATA_MODEL',
                                    `creator_id` varchar(256) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '创建人 ID',
                                    `delete_yn` tinyint(1) NOT NULL DEFAULT '0' COMMENT '逻辑删除标记',
                                    `created_at` datetime NOT NULL COMMENT '表记录创建时间',
                                    `updated_at` datetime NOT NULL COMMENT '表记录更新时间',
                                    `cluster_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                    `project_id` bigint(20) DEFAULT '1' COMMENT '项目id',
                                    `org_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                    `application_id` bigint(20) DEFAULT NULL COMMENT '应用id',
                                    `cluster_name` varchar(256) COLLATE utf8mb4_unicode_ci DEFAULT '' COMMENT '集群名称',
                                    PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='标签表';

CREATE TABLE `fdp_agent_model_record_detail` (
                                                 `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '主键id',
                                                 `model_id` bigint(20) NOT NULL COMMENT '模型id',
                                                 `model_name` varchar(128) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '模型名称',
                                                 `record_type` varchar(128) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '明细类型:表容量等',
                                                 `record_value` double NOT NULL COMMENT '类型值明细值,容量kb',
                                                 `day_value` bigint(20) NOT NULL COMMENT '日期',
                                                 `day_type` varchar(128) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '日期类型',
                                                 `created_at` datetime NOT NULL COMMENT '表记录创建时间',
                                                 `updated_at` datetime NOT NULL COMMENT '表记录更新时间',
                                                 `cluster_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                                 `project_id` bigint(20) DEFAULT '1' COMMENT '项目id',
                                                 `org_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                                 `application_id` bigint(20) DEFAULT NULL COMMENT '应用id',
                                                 `cluster_name` varchar(256) COLLATE utf8mb4_unicode_ci DEFAULT '' COMMENT '集群名称',
                                                 PRIMARY KEY (`id`),
                                                 KEY `idx_model_record` (`model_name`,`day_value`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='模型记录明细表';

CREATE TABLE `fdp_agent_onedata_atomic_metrics` (
                                                    `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '主键id',
                                                    `metrics_type` varchar(64) NOT NULL DEFAULT '' COMMENT '指标类型',
                                                    `metrics_name` varchar(64) NOT NULL DEFAULT '' COMMENT '指标名称',
                                                    `metrics_label` varchar(64) NOT NULL DEFAULT '' COMMENT '指标命名',
                                                    `data_type` varchar(64) NOT NULL DEFAULT '' COMMENT '数据类型',
                                                    `updated_by` bigint(20) NOT NULL COMMENT '最近修改人',
                                                    `updated_at` datetime NOT NULL COMMENT '最近修改时间',
                                                    `created_by` bigint(20) NOT NULL COMMENT '创建人',
                                                    `created_at` datetime NOT NULL COMMENT '创建时间',
                                                    PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='onedata原子指标表';

CREATE TABLE `fdp_agent_onedata_derived_metrics` (
                                                     `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '主键id',
                                                     `metrics_name` varchar(64) NOT NULL DEFAULT '' COMMENT '指标名称',
                                                     `metrics_label` varchar(64) NOT NULL DEFAULT '' COMMENT '指标命名',
                                                     `metrics_desc` varchar(64) NOT NULL DEFAULT '' COMMENT '指标描述',
                                                     `data_type` varchar(64) NOT NULL DEFAULT '' COMMENT '数据类型',
                                                     `updated_by` bigint(20) NOT NULL COMMENT '最近修改人',
                                                     `updated_at` datetime NOT NULL COMMENT '最近修改时间',
                                                     `created_by` bigint(20) NOT NULL COMMENT '创建人',
                                                     `created_at` datetime NOT NULL COMMENT '创建时间',
                                                     PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='onedata派生指标表';

CREATE TABLE `fdp_agent_onedata_frequency` (
                                               `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '主键id',
                                               `frequency_name` varchar(64) NOT NULL DEFAULT '' COMMENT '频率名称',
                                               `frequency_label` varchar(64) NOT NULL DEFAULT '' COMMENT '频率标识',
                                               `frequency_desc` varchar(64) NOT NULL DEFAULT '' COMMENT '频率描述',
                                               `updated_by` bigint(20) NOT NULL COMMENT '最近修改人',
                                               `updated_at` datetime NOT NULL COMMENT '最近修改时间',
                                               `created_by` bigint(20) NOT NULL COMMENT '创建人',
                                               `created_at` datetime NOT NULL COMMENT '创建时间',
                                               PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='onedata频率表';

CREATE TABLE `fdp_agent_onedata_increment` (
                                               `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '主键id',
                                               `increment_name` varchar(64) NOT NULL DEFAULT '' COMMENT '增量名称',
                                               `increment_label` varchar(64) NOT NULL DEFAULT '' COMMENT '增量标识',
                                               `increment_desc` varchar(64) NOT NULL DEFAULT '' COMMENT '增量描述',
                                               `updated_by` bigint(20) NOT NULL COMMENT '最近修改人',
                                               `updated_at` datetime NOT NULL COMMENT '最近修改时间',
                                               `created_by` bigint(20) NOT NULL COMMENT '创建人',
                                               `created_at` datetime NOT NULL COMMENT '创建时间',
                                               PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='onedata增量表';

CREATE TABLE `fdp_agent_onedata_model_level` (
                                                 `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '主键id',
                                                 `level_code` bigint(20) NOT NULL DEFAULT '0' COMMENT '层级编号',
                                                 `level_name` varchar(64) NOT NULL DEFAULT '' COMMENT '层级名称',
                                                 `level_desc` varchar(64) NOT NULL DEFAULT '' COMMENT '层级说明',
                                                 `level_prefix` varchar(64) NOT NULL DEFAULT '' COMMENT '层级前缀',
                                                 `level_lifycycle` bigint(20) DEFAULT '365' COMMENT '层级生命周期',
                                                 `is_marked_depend` tinyint(4) DEFAULT '0' COMMENT '是否记入层级依赖',
                                                 `updated_by` bigint(20) NOT NULL COMMENT '最近修改人',
                                                 `updated_at` datetime NOT NULL COMMENT '最近修改时间',
                                                 `created_by` bigint(20) NOT NULL COMMENT '创建人',
                                                 `created_at` datetime NOT NULL COMMENT '创建时间',
                                                 PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='onedata层级表';

CREATE TABLE `fdp_agent_quality_alarm_summary` (
                                                   `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '主键id',
                                                   `today_cnt` bigint(20) NOT NULL DEFAULT '0' COMMENT '今日告警数',
                                                   `last_sevenday_cnt` bigint(20) NOT NULL DEFAULT '0' COMMENT '最近7天',
                                                   `last_thirtyday_cnt` bigint(20) NOT NULL DEFAULT '0' COMMENT '最近30天',
                                                   `updater_id` bigint(20) NOT NULL COMMENT '最近修改人',
                                                   `updated_at` datetime NOT NULL COMMENT '最近修改时间',
                                                   `creator_id` bigint(20) NOT NULL COMMENT '创建人',
                                                   `created_at` datetime NOT NULL COMMENT '创建时间',
                                                   `cluster_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                                   `project_id` bigint(20) DEFAULT '1' COMMENT '项目id',
                                                   `org_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                                   `application_id` bigint(20) DEFAULT NULL COMMENT '应用id',
                                                   `cluster_name` varchar(256) DEFAULT '' COMMENT '集群名称',
                                                   PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='质量告警表';

CREATE TABLE `fdp_agent_quality_score_detail` (
                                                  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '主键id',
                                                  `model_id` bigint(20) NOT NULL DEFAULT '0' COMMENT '模型id',
                                                  `model_name` varchar(256) NOT NULL DEFAULT '0' COMMENT '模型名称',
                                                  `model_type` varchar(256) NOT NULL DEFAULT '0' COMMENT '模型类型',
                                                  `score` double(10,2) NOT NULL DEFAULT '0.00' COMMENT '全局得分',
                                                  `updater_id` bigint(20) NOT NULL COMMENT '最近修改人',
                                                  `updated_at` datetime NOT NULL COMMENT '最近修改时间',
                                                  `creator_id` bigint(20) NOT NULL COMMENT '创建人',
                                                  `created_at` datetime NOT NULL COMMENT '创建时间',
                                                  `total_model_score` bigint(20) DEFAULT '0' COMMENT '总得分',
                                                  `score_column_cnt` bigint(20) DEFAULT '0' COMMENT '总字段数',
                                                  `score_column_list` varchar(256) DEFAULT '' COMMENT '得分总字段名',
                                                  `cluster_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                                  `project_id` bigint(20) DEFAULT '1' COMMENT '项目id',
                                                  `org_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                                  `application_id` bigint(20) DEFAULT NULL COMMENT '应用id',
                                                  `cluster_name` varchar(256) DEFAULT '' COMMENT '集群名称',
                                                  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='质量得分详细表';

CREATE TABLE `fdp_agent_quality_score_trend` (
                                                 `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '主键id',
                                                 `score` double(10,2) NOT NULL DEFAULT '0.00' COMMENT '全局得分',
                                                 `updater_id` bigint(20) NOT NULL COMMENT '最近修改人',
                                                 `updated_at` datetime NOT NULL COMMENT '最近修改时间',
                                                 `creator_id` bigint(20) NOT NULL COMMENT '创建人',
                                                 `created_at` datetime NOT NULL COMMENT '创建时间',
                                                 `cluster_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                                 `project_id` bigint(20) DEFAULT '1' COMMENT '项目id',
                                                 `org_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                                 `application_id` bigint(20) DEFAULT NULL COMMENT '应用id',
                                                 `cluster_name` varchar(256) DEFAULT '' COMMENT '集群名称',
                                                 PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='质量得分趋势表';

CREATE TABLE `fdp_agent_quality_utility` (
                                             `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '主键id',
                                             `model_cnt` bigint(20) NOT NULL DEFAULT '0' COMMENT '模型数',
                                             `rule_cnt` bigint(20) NOT NULL DEFAULT '0' COMMENT '规则数',
                                             `new_model_cnt` bigint(20) NOT NULL DEFAULT '0' COMMENT '新增模型数',
                                             `new_rule_cnt` bigint(20) NOT NULL DEFAULT '0' COMMENT '规则数',
                                             `updater_id` bigint(20) NOT NULL COMMENT '最近修改人',
                                             `updated_at` datetime NOT NULL COMMENT '最近修改时间',
                                             `creator_id` bigint(20) NOT NULL COMMENT '创建人',
                                             `created_at` datetime NOT NULL COMMENT '创建时间',
                                             `cluster_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                             `project_id` bigint(20) DEFAULT '1' COMMENT '项目id',
                                             `org_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                             `application_id` bigint(20) DEFAULT NULL COMMENT '应用id',
                                             `cluster_name` varchar(256) DEFAULT '' COMMENT '集群名称',
                                             PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='质量得分效用表';

CREATE TABLE `fdp_agent_service_consumers` (
                                               `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '主键id',
                                               `org_id` bigint(20) DEFAULT NULL COMMENT '企业 id',
                                               `name` varchar(128) NOT NULL COMMENT '调用方名称',
                                               `description` varchar(1024) DEFAULT NULL COMMENT '描述',
                                               `dice_consumer_id` varchar(128) NOT NULL COMMENT 'dice API网关返回调用方id',
                                               `delete_yn` tinyint(1) NOT NULL DEFAULT '0' COMMENT '逻辑删除标记',
                                               `creator_id` varchar(128) DEFAULT NULL COMMENT '创建人 ID',
                                               `updater_id` varchar(128) DEFAULT NULL COMMENT '更新者ID',
                                               `created_at` datetime NOT NULL COMMENT '表记录创建时间',
                                               `updated_at` datetime NOT NULL COMMENT '表记录更新时间',
                                               `cluster_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                               `project_id` bigint(20) DEFAULT '1' COMMENT '项目id',
                                               `application_id` bigint(20) DEFAULT NULL COMMENT '应用id',
                                               `cluster_name` varchar(256) DEFAULT '' COMMENT '集群名称',
                                               PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='调用方列表';

CREATE TABLE `fdp_agent_service_consumers_rel_ak` (
                                                      `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '主键id',
                                                      `org_id` bigint(20) DEFAULT NULL COMMENT '企业 id',
                                                      `consumer_id` bigint(20) NOT NULL COMMENT '调用方ID',
                                                      `access_key` varchar(256) NOT NULL COMMENT 'access key',
                                                      `created_at` datetime NOT NULL COMMENT '表记录创建时间',
                                                      `updated_at` datetime NOT NULL COMMENT '表记录更新时间',
                                                      `cluster_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                                      `project_id` bigint(20) DEFAULT '1' COMMENT '项目id',
                                                      `application_id` bigint(20) DEFAULT NULL COMMENT '应用id',
                                                      `cluster_name` varchar(256) DEFAULT '' COMMENT '集群名称',
                                                      PRIMARY KEY (`id`),
                                                      KEY `idx_access_key` (`access_key`(255))
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='调用方与ak关联表';

CREATE TABLE `fdp_agent_service_consumers_rel_data_api` (
                                                            `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '主键id',
                                                            `org_id` bigint(20) DEFAULT NULL COMMENT '企业 id',
                                                            `consumer_id` bigint(20) NOT NULL COMMENT '调用方ID',
                                                            `data_api_id` bigint(20) NOT NULL COMMENT 'api id',
                                                            `grant_auth_status` tinyint(1) NOT NULL DEFAULT '0' COMMENT '是否被授权',
                                                            `creator_id` varchar(128) DEFAULT NULL COMMENT '创建人 ID',
                                                            `updater_id` varchar(128) DEFAULT NULL COMMENT '更新者ID',
                                                            `created_at` datetime NOT NULL COMMENT '表记录创建时间',
                                                            `updated_at` datetime NOT NULL COMMENT '表记录更新时间',
                                                            `cluster_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                                            `project_id` bigint(20) DEFAULT '1' COMMENT '项目id',
                                                            `application_id` bigint(20) DEFAULT NULL COMMENT '应用id',
                                                            `cluster_name` varchar(256) DEFAULT '' COMMENT '集群名称',
                                                            PRIMARY KEY (`id`),
                                                            KEY `idx_consumer_scenario_id` (`consumer_id`,`data_api_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='调用方与api表';

CREATE TABLE `fdp_agent_sql_histories` (
                                           `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '主键id',
                                           `data_model_id` bigint(20) NOT NULL COMMENT '数据模型 ID',
                                           `name` varchar(256) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '执行记录名称',
                                           `sql` text COLLATE utf8mb4_unicode_ci NOT NULL COMMENT '执行的 SQL',
                                           `result` text COLLATE utf8mb4_unicode_ci NOT NULL COMMENT 'SQL 执行结果',
                                           `creator_id` varchar(256) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '创建人 ID',
                                           `created_at` datetime NOT NULL COMMENT '表记录创建时间',
                                           `updated_at` datetime NOT NULL COMMENT '表记录更新时间',
                                           `cluster_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                           `project_id` bigint(20) DEFAULT '1' COMMENT '项目id',
                                           `org_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                           `application_id` bigint(20) DEFAULT NULL COMMENT '应用id',
                                           `cluster_name` varchar(256) COLLATE utf8mb4_unicode_ci DEFAULT '' COMMENT '集群名称',
                                           PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='sql执行历史表';

CREATE TABLE `fdp_agent_tag_sync_logs` (
                                           `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '主键id',
                                           `tag_id` bigint(20) NOT NULL COMMENT '标签 Id',
                                           `tag_name` varchar(128) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '标签名称',
                                           `pipeline_ids` varchar(128) COLLATE utf8mb4_unicode_ci DEFAULT '' COMMENT 'pipeline ids',
                                           `status` varchar(32) COLLATE utf8mb4_unicode_ci NOT NULL COMMENT '标签同步状态',
                                           `created_at` datetime NOT NULL COMMENT '表记录创建时间',
                                           `updated_at` datetime NOT NULL COMMENT '表记录更新时间',
                                           `cluster_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                           `project_id` bigint(20) DEFAULT '1' COMMENT '项目id',
                                           `org_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                           `application_id` bigint(20) DEFAULT NULL COMMENT '应用id',
                                           `cluster_name` varchar(256) COLLATE utf8mb4_unicode_ci DEFAULT '' COMMENT '集群名称',
                                           PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='标签同步日志表';

CREATE TABLE `fdp_agent_tag_values` (
                                        `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '主键id',
                                        `tag_id` bigint(20) NOT NULL COMMENT '标签 Id',
                                        `name` varchar(128) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '标签值名称',
                                        `description` text COLLATE utf8mb4_unicode_ci COMMENT '描述',
                                        `logic_type` varchar(32) COLLATE utf8mb4_unicode_ci NOT NULL COMMENT '标签值关联关系',
                                        `created_at` datetime NOT NULL COMMENT '表记录创建时间',
                                        `updated_at` datetime NOT NULL COMMENT '表记录更新时间',
                                        `cluster_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                        `project_id` bigint(20) DEFAULT '1' COMMENT '项目id',
                                        `org_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                        `application_id` bigint(20) DEFAULT NULL COMMENT '应用id',
                                        `cluster_name` varchar(256) COLLATE utf8mb4_unicode_ci DEFAULT '' COMMENT '集群名称',
                                        PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='标签值表';

CREATE TABLE `fdp_agent_tags` (
                                  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '主键id',
                                  `name` varchar(128) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '标签名称',
                                  `description` text COLLATE utf8mb4_unicode_ci COMMENT '描述',
                                  `code` varchar(32) COLLATE utf8mb4_unicode_ci NOT NULL COMMENT '标签码',
                                  `type` varchar(32) COLLATE utf8mb4_unicode_ci NOT NULL COMMENT '标签类型',
                                  `value_type` varchar(40) COLLATE utf8mb4_unicode_ci NOT NULL COMMENT '标签值类型',
                                  `status` varchar(32) COLLATE utf8mb4_unicode_ci DEFAULT '' COMMENT '标签同步状态',
                                  `disabled` tinyint(1) DEFAULT NULL COMMENT '停用',
                                  `created_at` datetime NOT NULL COMMENT '表记录创建时间',
                                  `updated_at` datetime NOT NULL COMMENT '表记录更新时间',
                                  `cluster_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                  `project_id` bigint(20) DEFAULT '1' COMMENT '项目id',
                                  `org_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                  `application_id` bigint(20) DEFAULT NULL COMMENT '应用id',
                                  `cluster_name` varchar(256) COLLATE utf8mb4_unicode_ci DEFAULT '' COMMENT '集群名称',
                                  PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='标签表';

CREATE TABLE `fdp_agent_user_action_log_detail` (
                                                    `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '主键id',
                                                    `user_id` varchar(64) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '用户id',
                                                    `action_type` varchar(64) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '动作类型：搜索/查看/引用',
                                                    `action_content` varchar(64) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '动作内容:搜索条件/查看条件/引用条件',
                                                    `result_model_name` varchar(128) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '涉及结果模型表名称',
                                                    `result_model_id` bigint(20) NOT NULL COMMENT '涉及结果模型表id',
                                                    `action_result` varchar(64) COLLATE utf8mb4_unicode_ci NOT NULL DEFAULT '' COMMENT '动作结果：搜索结果/查看结果/引用结果',
                                                    `created_at` datetime NOT NULL COMMENT '表记录创建时间',
                                                    `updated_at` datetime NOT NULL COMMENT '表记录更新时间',
                                                    `cluster_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                                    `project_id` bigint(20) DEFAULT '1' COMMENT '项目id',
                                                    `org_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                                    `application_id` bigint(20) DEFAULT NULL COMMENT '应用id',
                                                    `cluster_name` varchar(256) COLLATE utf8mb4_unicode_ci DEFAULT '' COMMENT '集群名称',
                                                    PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='用户动作日志表';

CREATE TABLE `fdp_agent_value_indicators` (
                                              `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '主键id',
                                              `tag_id` bigint(20) NOT NULL COMMENT '标签 Id',
                                              `value_id` bigint(20) NOT NULL COMMENT '标签值 Id',
                                              `indicator_id` bigint(20) NOT NULL COMMENT '指标 Id',
                                              `tag_compute_type` varchar(64) COLLATE utf8mb4_unicode_ci NOT NULL COMMENT '标签计算类型',
                                              `min_range` varchar(32) COLLATE utf8mb4_unicode_ci NOT NULL COMMENT '最小值',
                                              `max_range` varchar(32) COLLATE utf8mb4_unicode_ci NOT NULL COMMENT '最大值',
                                              `created_at` datetime NOT NULL COMMENT '表记录创建时间',
                                              `updated_at` datetime NOT NULL COMMENT '表记录更新时间',
                                              `cluster_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                              `project_id` bigint(20) DEFAULT '1' COMMENT '项目id',
                                              `org_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                              `application_id` bigint(20) DEFAULT NULL COMMENT '应用id',
                                              `cluster_name` varchar(256) COLLATE utf8mb4_unicode_ci DEFAULT '' COMMENT '集群名称',
                                              PRIMARY KEY (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='指标值表';

CREATE TABLE `fdp_agent_workflow_indicators` (
                                                 `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '主键id',
                                                 `execute_time_top_daily_result` text COMMENT '执行时长排行top10',
                                                 `failed_time_top_30_days_result` text COMMENT '最近30天执行top10',
                                                 `statistical_date` varchar(128) DEFAULT NULL COMMENT '统计日期',
                                                 `created_at` datetime NOT NULL COMMENT '表记录创建时间',
                                                 `updated_at` datetime NOT NULL COMMENT '表记录更新时间',
                                                 `cluster_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                                 `project_id` bigint(20) DEFAULT '1' COMMENT '项目id',
                                                 `org_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                                 `application_id` bigint(20) DEFAULT NULL COMMENT '应用id',
                                                 `cluster_name` varchar(256) DEFAULT '' COMMENT '集群名称',
                                                 PRIMARY KEY (`id`),
                                                 KEY `idx_statistical_date` (`statistical_date`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='工作流指标值表';

CREATE TABLE `fdp_agent_workflow_period_statistics` (
                                                        `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT COMMENT '主键id',
                                                        `statistics` varchar(1024) DEFAULT NULL COMMENT '每日完成数量',
                                                        `statistical_date` varchar(128) DEFAULT NULL COMMENT '统计日期',
                                                        `created_at` datetime NOT NULL COMMENT '表记录创建时间',
                                                        `updated_at` datetime NOT NULL COMMENT '表记录更新时间',
                                                        `cluster_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                                        `project_id` bigint(20) DEFAULT '1' COMMENT '项目id',
                                                        `org_id` bigint(20) DEFAULT NULL COMMENT '集群id',
                                                        `application_id` bigint(20) DEFAULT NULL COMMENT '应用id',
                                                        `cluster_name` varchar(256) DEFAULT '' COMMENT '集群名称',
                                                        PRIMARY KEY (`id`),
                                                        KEY `idx_statistical_date` (`statistical_date`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8 COMMENT='工作流日期统计表';
