{
  "id":"slave_sync_alert",
  "expression":{
    "filters":[
      {
        "operator":"eq",
        "tag":"org_name",
        "value":"$org_name"
      },
      {
        "operator":"eq",
        "tag":"is_slave",
        "value":"true"
      }
    ],
    "functions":[
      {
        "aggregator":"max",
        "alias":"slave_slave_sync_ok_value",
        "field":"slave_slave_sync_ok",
        "field_script":"function invoke(fields,tags){if (fields.slave_slave_io_running == 0 || fields.slave_slave_sql_running == 0) {return 0} return 1}",
        "operator":"eq",
        "value":0
      },
      {
        "aggregator":"max",
        "alias":"slave_slave_io_running_value",
        "field":"slave_slave_io_running"
      },
      {
        "aggregator":"max",
        "alias":"slave_slave_sql_running_value",
        "field":"slave_slave_sql_running"
      }
    ],
    "group":[
      "addon_id",
      "server"
    ],
    "metric":"mysql",
    "outputs":[
      "alert"
    ],
    "select":{
      "addon_id":"#addon_id",
      "cluster_name":"#cluster_name",
      "org_name":"#org_name",
      "server_id":"#server"
    },
    "window":1
  }
}
