{
  "id":"app_status_code",
  "expression":{
    "filters":[
      {
        "operator":"eq",
        "tag":"terminus_key",
        "value":"$terminus_key"
      },
      {
        "operator":"eq",
        "tag":"type",
        "value":"http"
      }
    ],
    "functions":[
      {
        "aggregator":"sum",
        "field":"retry"
      },
      {
        "aggregator":"min",
        "field":"code",
        "operator":"gte",
        "value":400
      }
    ],
    "group":[
      "metric"
    ],
    "metric":"status_page",
    "outputs":[
      "alert"
    ],
    "select":{
      "metric_id":"#metric",
      "project_id":"#project_id",
      "project_name":"#project_name",
      "status_metric_name":"#metric_name",
      "terminus_key":"#terminus_key",
      "type":"#type",
      "url":"#url",
      "workspace":"#env"
    },
    "window":1
  }
}
