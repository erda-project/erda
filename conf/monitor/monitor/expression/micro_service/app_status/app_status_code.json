{
  "name": "主动监控HTTP状态异常",
  "alert_scope": "micro_service",
  "attributes": {
    "level": "Notice",
    "recover": "true",
    "display_url_id": "micro_status_detail",
    "alert_group": "{{terminus_key}}-{{metric_id}}",
    "tickets_metric_key": "{{metric_id}}"
  },
  "template": {
    "metric": "status_page",
    "window": 1,
    "filters": [
      {
        "tag": "terminus_key",
        "operator": "eq",
        "value": "$terminus_key"
      },
      {
        "tag": "type",
        "operator": "eq",
        "value": "http"
      }
    ],
    "group": [
      "metric"
    ],
    "functions": [
      {
        "aggregator": "sum",
        "field": "retry"
      },
      {
        "aggregator": "min",
        "field": "code",
        "operator": "gte",
        "value": 400
      }
    ],
    "select": {
      "url": "#url",
      "type": "#type",
      "metric_id": "#metric",
      "project_id": "#project_id",
      "project_name": "#project_name",
      "workspace": "#env",
      "terminus_key": "#terminus_key",
      "status_metric_name": "#metric_name"
    },
    "outputs": [
      "alert"
    ]
  }
}
