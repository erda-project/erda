routes:
  - path: /v1/responses
    method: POST
    request_filters:
      - name: audit
        config: { stage: in-log }
      - name: rate-limit
      - name: audit # save audit after rate limit
        config: { stage: in-create-audit }
      - name: context-authorization
      - name: context
      - name: context-responses
      - name: audit
        config: { stage: in-context-parsed }
      - name: reserved-header
      - name: thinking-handler
      - name: openai-compatible-director
      - name: set-response-chunk-splitter
      - name: audit
        config: { stage: out-log }
      - name: audit
        config: { stage: out-update }
    response_filters:
      - name: audit
        config: { stage: in-log }
      - name: audit
        config: { stage: in-update }
      - name: set-ai-proxy-header
      - name: ensure-content-type
      - name: audit
        config: { stage: in-parsed }
      - name: audit
        config: { stage: out-log }
      - name: json-no-unicode
      - name: error-status-handler

  - path: /v1/responses/{response_id}
    method: GET
    request_filters:
      - name: audit
        config: { stage: in-log }
      - name: context-authorization
      - name: context
      - name: openai-compatible-director
      - name: audit
        config: { stage: out-log }
    response_filters:
      - name: audit
        config: { stage: in-log }
      - name: set-ai-proxy-header
      - name: ensure-content-type
      - name: audit
        config: { stage: out-log }
      - name: json-no-unicode
      - name: error-status-handler

  - path: /v1/responses/{response_id}
    method: DELETE
    request_filters:
      - name: audit
        config: { stage: in-log }
      - name: context-authorization
      - name: context
      - name: openai-compatible-director
      - name: audit
        config: { stage: out-log }
    response_filters:
      - name: audit
        config: { stage: in-log }
      - name: set-ai-proxy-header
      - name: ensure-content-type
      - name: audit
        config: { stage: out-log }
      - name: json-no-unicode
      - name: error-status-handler

  - path: /v1/responses/{response_id}/input_items
    method: GET
    request_filters:
      - name: audit
        config: { stage: in-log }
      - name: context-authorization
      - name: context
      - name: openai-compatible-director
      - name: audit
        config: { stage: out-log }
    response_filters:
      - name: audit
        config: { stage: in-log }
      - name: set-ai-proxy-header
      - name: ensure-content-type
      - name: audit
        config: { stage: out-log }
      - name: json-no-unicode
      - name: error-status-handler
