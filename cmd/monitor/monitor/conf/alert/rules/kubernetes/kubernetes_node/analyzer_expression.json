{
  "id":"kubernetes_node",
  "expression":{
    "filters":[
      {
        "operator":"eq",
        "tag":"org_name",
        "value":"$org_name"
      },
      {
        "operator":"neq",
        "tag":"offline",
        "value":"true"
      }
    ],
    "functions":[
      {
        "aggregator":"values",
        "field":"ready",
        "operator":"all",
        "value":false
      },
      {
        "aggregator":"max",
        "alias":"allocatable_pods_value",
        "field":"allocatable_pods"
      },
      {
        "aggregator":"max",
        "alias":"capacity_pods_value",
        "field":"capacity_pods"
      },
      {
        "aggregator":"max",
        "alias":"allocatable_cpu_cores_value",
        "field":"allocatable_cpu_cores"
      },
      {
        "aggregator":"max",
        "alias":"capacity_cpu_cores_value",
        "field":"capacity_cpu_cores"
      },
      {
        "aggregator":"max",
        "alias":"allocatable_memory_bytes_value",
        "field":"allocatable_memory_bytes"
      },
      {
        "aggregator":"max",
        "alias":"capacity_memory_bytes_value",
        "field":"capacity_memory_bytes"
      }
    ],
    "group":[
      "cluster_name",
      "node_name"
    ],
    "metrics":[
      "kubernetes_node"
    ],
    "outputs":[
      "alert"
    ],
    "select":{
      "_meta":"#_meta",
      "_metric_scope":"#_metric_scope",
      "_metric_scope_id":"#_metric_scope_id",
      "cluster_name":"#cluster_name",
      "component_name":"#node_name",
      "node_name":"#node_name",
      "org_name":"#org_name"
    },
    "window":1
  }
}
