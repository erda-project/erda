{
  "id":"app_transaction_http_path_rt",
  "expression":{
    "condition":"and",
    "filters":[
      {
        "operator":"eq",
        "tag":"target_terminus_key",
        "value":"$terminus_key"
      }
    ],
    "functions":[
      {
        "aggregator":"sum",
        "field":"elapsed",
        "field_script":"function invoke(field, tag){ return field.elapsed_sum / 1000000; }"
      },
      {
        "aggregator":"sum",
        "field":"elapsed_count",
        "operator":"gte",
        "value":10
      },
      {
        "aggregator":"value",
        "field":"elapsed_avg",
        "field_script":"function invoke(field, tag){ if(!field.elapsed_count_sum) return 0; return field.elapsed_count_sum === 0 ? 0 : (field.elapsed_sum / field.elapsed_count_sum);}",
        "operator":"gte",
        "trigger":"aggregated",
        "value":3000
      }
    ],
    "group":[
      "target_runtime_id",
      "target_service_name",
      "http_path",
      "http_method"
    ],
    "metric":"application_http",
    "outputs":[
      "alert"
    ],
    "select":{
      "application_name":"#target_application_name",
      "http_method":"#http_method",
      "http_path":"#http_path",
      "http_url":"#http_url",
      "project_id":"#target_project_id",
      "project_name":"#target_project_name",
      "runtime_id":"#target_runtime_id",
      "runtime_name":"#target_runtime_name",
      "service_name":"#target_service_name",
      "terminus_key":"#target_terminus_key",
      "workspace":"#target_workspace"
    },
    "window":1
  }
}
