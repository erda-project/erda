{
  "id":"dice_addon_container_mem",
  "expression":{
    "filters":[
      {
        "operator":"eq",
        "tag":"org_name",
        "value":"$org_name"
      },
      {
        "operator":"eq",
        "tag":"pod_namespace",
        "value":"default"
      },
      {
        "operator":"any",
        "tag":"addon_id"
      }
    ],
    "functions":[
      {
        "aggregator":"avg",
        "field":"mem_usage_percent",
        "operator":"gt",
        "value":80
      },
      {
        "aggregator":"max",
        "alias":"mem_usage_value",
        "field":"mem_usage"
      },
      {
        "aggregator":"max",
        "alias":"mem_limit_value",
        "field":"mem_limit"
      },
      {
        "aggregator":"max",
        "alias":"mem_max_value",
        "field":"mem_max_usage"
      },
      {
        "aggregator":"max",
        "alias":"mem_allocation_value",
        "field":"mem_allocation"
      }
    ],
    "group":[
      "cluster_name",
      "container_id"
    ],
    "metrics":[
      "docker_container_summary"
    ],
    "outputs":[
      "alert"
    ],
    "select":{
      "_meta":"#_meta",
      "_metric_scope":"#_metric_scope",
      "_metric_scope_id":"#_metric_scope_id",
      "addon_id":"#addon_id",
      "cluster_name":"#cluster_name",
      "container_id":"#container_id",
      "host_ip":"#host_ip",
      "org_name":"#org_name",
      "pod_ip":"#pod_ip",
      "pod_name":"#pod_name",
      "pod_namespace":"#pod_namespace"
    },
    "window":2
  }
}
